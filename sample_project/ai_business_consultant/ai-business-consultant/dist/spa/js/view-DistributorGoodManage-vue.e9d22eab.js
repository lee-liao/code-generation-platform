(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[11],{"68f2":function(e,t,a){},"6fd10":function(e,t,a){"use strict";a.r(t);var l=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"w-full h-full px-12"},[a("div",{staticStyle:{width:"100%",margin:"20px 0",display:"flex","justify-content":"space-between"}},[a("el-input",{staticStyle:{width:"200px"},attrs:{placeholder:e.$t("People.searchForName")},on:{input:e.handleInputSearch},model:{value:e.searchValue,callback:function(t){e.searchValue=t},expression:"searchValue"}},[a("i",{staticClass:"el-input__icon el-icon-search",attrs:{slot:"prefix"},slot:"prefix"})])],1),a("div",[a("el-table",{staticClass:"mb-5",staticStyle:{width:"100%"},attrs:{data:e.TabelDate.slice((e.currentPage-1)*e.pageSize,e.currentPage*e.pageSize),border:"",loading:e.loading,"empty-text":e.$t("People.noData")}},[a("el-table-column",{attrs:{prop:"name",label:e.$t("goods.name"),align:"center","min-width":"100%"}}),a("el-table-column",{attrs:{label:e.$t("goods.mainImg"),align:"center","min-width":"100%"},scopedSlots:e._u([{key:"default",fn:function(t){return[t.row.mainImg?a("el-image",{staticStyle:{width:"60px",height:"60px"},attrs:{src:t.row.mainImg,fit:e.fit}}):e._e()]}}])}),a("el-table-column",{attrs:{label:e.$t("goods.projectType"),align:"center","min-width":"100%"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n          "+e._s(null!=t.row.legalDocumentProject?t.row.legalDocumentProject.name:e.$t("Distributor.legaladvice"))+"\n        ")]}}])}),a("el-table-column",{attrs:{prop:"status",label:e.$t("goods.status"),align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n          "+e._s(e.getStatus(t.row.status))+"\n        ")]}}])}),a("el-table-column",{attrs:{prop:"price",label:e.$t("goods.price"),align:"center"}}),a("el-table-column",{attrs:{prop:"description",label:e.$t("goods.description"),align:"center"}}),a("el-table-column",{attrs:{prop:"createdAt",label:e.$t("goods.createdAt"),align:"center",formatter:e.formatterTime}}),a("el-table-column",{attrs:{prop:"updatedAt",label:e.$t("goods.updatedAt"),align:"center",formatter:e.formatterTime}}),1==e.currentUser.role||3==e.currentUser.role?a("el-table-column",{attrs:{label:e.$t("People.action"),align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{disabled:3==e.currentUser.role&&t.row.creatorId!=e.currentUser.id,type:"text"},on:{click:function(a){return e.handleStatue(t.row)}}},[e._v("\n            "+e._s("Release"==t.row.status?e.$t("goods.offline"):e.$t("goods.release"))+"\n          ")]),a("el-button",{attrs:{disabled:3==e.currentUser.role&&t.row.creatorId!=e.currentUser.id,type:"text"},on:{click:function(a){return e.handleEdit(t.$index,t.row)}}},[e._v("\n            "+e._s(e.$t("People.edit"))+"\n          ")])]}}],null,!1,3576331208)}):e._e()],1),a("el-pagination",{attrs:{"current-page":e.currentPage,"page-sizes":[5,10,20,50],"page-size":e.pageSize,total:e.TabelDate.length,layout:"total, sizes, prev, pager, next, jumper"},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}})],1),a("el-dialog",{staticClass:"channel-dialog",attrs:{"close-on-click-modal":!1,visible:e.dialogGoodVisible,title:e.createOrEditTitle,width:"50%","append-to-body":!0},on:{"update:visible":function(t){e.dialogGoodVisible=t}}},[a("el-form",{ref:"goodForm",attrs:{model:e.goodMessage,rules:e.goodRules,"label-width":"110px","label-position":"left"}},[a("el-form-item",{attrs:{label:e.$t("goods.name"),prop:"name"}},[a("el-input",{staticClass:"channel-input",attrs:{"validate-event":!1,autocomplete:"off"},model:{value:e.goodMessage.name,callback:function(t){e.$set(e.goodMessage,"name",t)},expression:"goodMessage.name"}})],1),a("el-form-item",{attrs:{label:e.$t("goods.mainImg")}},[a("div",{staticClass:"row items-center"},[a("q-img",{staticClass:"imgbox mr-3",style:{width:"100px",height:"100px",border:"1px  solid grey"},attrs:{src:e.goodMessage.mainImg}}),a("el-upload",{ref:"uploadRef",staticClass:"upload-demo",attrs:{action:"","http-request":e.beforeupload,"show-file-list":!1,accept:"image/jpg,image/jpeg,image/png"}},[a("el-button",{attrs:{type:"primary"}},[e._v(e._s(e.$t("profile.selectimage")))])],1)],1)]),a("el-form-item",{attrs:{label:e.$t("goods.carouselImgs")}},[a("div",{staticClass:"row items-center"},[e.goodMessage.carouselImgs.length?[e._l(e.goodMessage.carouselImgs,(function(t,l){return[a("div",{staticClass:"imgbox-box mr-3 mb-1"},[a("q-img",{staticClass:"imgbox",attrs:{src:t}}),a("div",{staticClass:"delete-icon"},[a("el-button",{attrs:{type:"danger",size:"mini",icon:"el-icon-delete",circle:""},on:{click:function(t){return e.handleRemoveCarouselImg(l)}}})],1)],1)]}))]:a("q-img",{staticClass:"imgbox mr-3",style:{width:"100px",height:"100px",border:"1px  solid grey"}}),a("el-upload",{ref:"uploadRef",staticClass:"upload-demo",attrs:{action:"","http-request":e.beforeuploadCarouselImgs,"show-file-list":!1,accept:"image/jpg,image/jpeg,image/png"}},[a("el-button",{attrs:{type:"primary"}},[e._v(e._s(e.$t("profile.selectimage")))])],1)],2)]),a("el-form-item",{attrs:{label:e.$t("goods.detailImgs")}},[a("div",{staticClass:"row items-center"},[e.goodMessage.detailImgs.length?[e._l(e.goodMessage.detailImgs,(function(t,l){return[a("div",{staticClass:"imgbox-box mr-3 mb-1"},[a("q-img",{staticClass:"imgbox",attrs:{src:t}}),a("div",{staticClass:"delete-icon"},[a("el-button",{attrs:{type:"danger",size:"mini",icon:"el-icon-delete",circle:""},on:{click:function(t){return e.handleRemoveDetailImg(l)}}})],1)],1)]}))]:a("q-img",{staticClass:"imgbox mr-3",style:{width:"100px",height:"100px",border:"1px  solid grey"}}),a("el-upload",{ref:"uploadRef",staticClass:"upload-demo",attrs:{action:"","http-request":e.beforeuploadDetailImgs,"show-file-list":!1,accept:"image/jpg,image/jpeg,image/png"}},[a("el-button",{attrs:{type:"primary"}},[e._v(e._s(e.$t("profile.selectimage")))])],1)],2)]),a("el-form-item",{attrs:{label:e.$t("goods.price"),prop:"price"}},[a("el-input",{staticClass:"channel-input",attrs:{"validate-event":!1,autocomplete:"off"},on:{input:function(t){return e.goodMessage.price=t.replace(/[^\d.]/g,"")}},model:{value:e.goodMessage.price,callback:function(t){e.$set(e.goodMessage,"price",t)},expression:"goodMessage.price"}})],1),a("el-form-item",{attrs:{label:e.$t("goods.marketPrice"),prop:"marketPrice"}},[a("el-input",{staticClass:"channel-input",attrs:{"validate-event":!1,autocomplete:"off"},on:{input:function(t){return e.goodMessage.marketPrice=t.replace(/[^\d.]/g,"")}},model:{value:e.goodMessage.marketPrice,callback:function(t){e.$set(e.goodMessage,"marketPrice",t)},expression:"goodMessage.marketPrice"}})],1),a("el-form-item",{attrs:{label:e.$t("goods.description"),prop:"marketPrice"}},[a("el-input",{staticClass:"channel-input",attrs:{type:"textarea",rows:2},model:{value:e.goodMessage.description,callback:function(t){e.$set(e.goodMessage,"description",t)},expression:"goodMessage.description"}})],1),a("el-form-item",{attrs:{label:e.$t("goods.checkLawer"),prop:"marketPrice"}},[a("el-select",{staticStyle:{width:"100%"},attrs:{clearable:"",filterable:"",multiple:"",placeholder:e.$t("People.PleaseSelect")},model:{value:e.goodMessage.lawyers,callback:function(t){e.$set(e.goodMessage,"lawyers",t)},expression:"goodMessage.lawyers"}},e._l(e.allLawyer,(function(e){return a("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})})),1)],1),a("el-form-item",{attrs:{label:e.$t("goods.details"),prop:"details"}},[a("el-input",{staticClass:"channel-input",attrs:{type:"textarea",rows:2},model:{value:e.goodMessage.details,callback:function(t){e.$set(e.goodMessage,"details",t)},expression:"goodMessage.details"}})],1),a("el-form-item",{attrs:{label:e.$t("goods.private"),prop:"state"}},[a("q-checkbox",{attrs:{"true-value":"Private","false-value":"Public"},model:{value:e.goodMessage.state,callback:function(t){e.$set(e.goodMessage,"state",t)},expression:"goodMessage.state"}})],1),e.isEdit?a("el-form-item",{attrs:{prop:"state",label:e.$t("Distributor.H5link")}},[a("span",[e._v(e._s(e.goodMessage.h5Link))]),a("i",{staticClass:"el-icon-document-copy ml-3 cursor-pointer",on:{click:e.handlecopy}})]):e._e(),e.isEdit?a("el-form-item",{attrs:{prop:"state",label:e.$t("Distributor.LinkQRcode")}},[a("div",{staticStyle:{display:"flex","align-items":"center"}},[a("el-image",{staticStyle:{width:"100px",height:"100px"},attrs:{src:e.goodMessage.qrCode,fit:e.fit}}),a("el-button",{staticClass:"mb-3",attrs:{icon:"el-icon-download"},on:{click:e.handleDownload}})],1)]):e._e()],1),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.dialogGoodVisible=!1}}},[e._v(e._s(e.$t("People.cancel")))]),a("el-button",{attrs:{type:"primary"},on:{click:e.handleSubmitMessage}},[e._v(e._s(e.$t("People.confirm")))])],1)],1),a("el-dialog",{attrs:{title:e.$t("goods.copygoods"),"close-on-click-modal":!1,width:"30%",visible:e.dialogCopyVisible},on:{"update:visible":function(t){e.dialogCopyVisible=t}}},[a("el-form",[a("el-form-item",{attrs:{label:e.$t("goods.name")}},[a("el-input",{attrs:{autocomplete:"off"},model:{value:e.copyname,callback:function(t){e.copyname=t},expression:"copyname"}})],1),a("el-form-item",{attrs:{label:e.$t("goods.projectType"),prop:"role"}},[a("el-select",{staticStyle:{width:"100%"},attrs:{clearable:"",filterable:"",placeholder:e.$t("People.PleaseSelect")},model:{value:e.copyProjectId,callback:function(t){e.copyProjectId=t},expression:"copyProjectId"}},e._l(e.projectDatas,(function(e){return a("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})})),1)],1)],1),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.dialogCopyVisible=!1}}},[e._v(e._s(e.$t("profile.Cancel")))]),a("el-button",{attrs:{type:"primary"},on:{click:e.handleSubmitCopy}},[e._v(e._s(e.$t("profile.Confirm")))])],1)],1)],1)},o=[],s=(a("ddb0"),a("2b3d"),a("9861"),a("caad"),a("750b")),i=a("b850"),r=a("1840"),c=a("5a0c"),n=a.n(c),d=a("6eb7"),u=a("436b"),m=a("f508"),p=a("cdde"),g=a("f896"),b=a("ef50"),f=a("8ee3"),v=a("86c4"),h=a("bc3a"),y=a.n(h),w=a("fadb"),$=Object(s["defineComponent"])({data(){return{isMobile:Object(w["a"])(),currentPage:1,pageSize:10}},mounted(){Object(w["b"])(this,"isMobile")},setup(e,{root:t}){const a=Object(s["ref"])(!1),l=Object(s["ref"])([]),o=Object(s["ref"])([]),c=Object(s["ref"])([]),h=Object(s["ref"])(""),w=Object(s["ref"])(""),$=Object(s["ref"])(""),I=Object(s["ref"])(""),j=Object(s["computed"])(i["b"].currentUser),{mutate:k}=Object(r["useMutation"])(g["d"]),{mutate:C}=Object(r["useMutation"])(g["a"]),{mutate:P}=Object(r["useMutation"])(v["e"]),{mutate:x}=Object(r["useMutation"])(b["h"]),{mutate:M}=Object(r["useMutation"])(g["h"]),{mutate:O}=Object(r["useMutation"])(b["c"]),_=async()=>{const e=await P();e&&(c.value=e.data.getLegalDocumentProjects)},S=e=>{const t=e.lastIndexOf("-");if(-1===t)return e+"-1";const a=e.slice(t+1),l=parseInt(a,10);return isNaN(l)?e+"-1":e.slice(0,t+1)+(l+1)},D=async e=>{w.value=S(e.name),$.value=e.id,I.value=e.legalDocumentProject.id,R.value=!0},R=Object(s["ref"])(!1),U=Object(s["ref"])([]),q=async()=>{const e=await O();e&&(U.value=e.data.getUserLawyers)},L=async()=>{try{a.value=!0;const{data:{getCommoditys:e}}=await k();e.forEach((e=>{e.price=e.price/100,e.marketPrice=e.marketPrice/100})),l.value=e,o.value=e,a.value=!1,console.log(o.value)}catch(e){console.log("----------getGoods error")}},T=()=>{Object(p["a"])(J.value.h5Link),d["a"].success(t.$t("flow.CopySuccess"))},z=async()=>{try{const e=J.value.qrCode,t=await y()({url:e,method:"GET",responseType:"blob"}),a=window.URL.createObjectURL(new Blob([t.data])),l=document.createElement("a");l.href=a,l.setAttribute("download","downloaded_image.jpg"),document.body.appendChild(l),l.click(),window.URL.revokeObjectURL(a),document.body.removeChild(l)}catch(e){console.error(t.$t("Distributor.Anerroroccurred"),e)}},V=(e,t="YYYY/MM/DD  HH:mm:ss")=>e?n()(e).format(t):e,E=e=>{let t=V(e.createdAt);return t},A=e=>{switch(e.role){case 1:return t.$t("People.Administrators");case 2:return t.$t("People.Lawyer")}},N=[{value:1,label:t.$t("People.Administrators")},{value:2,label:t.$t("People.Lawyer")}],G=Object(s["ref"])(""),Y=()=>{o.value=l.value.filter((e=>e.name.includes(G.value))),console.log(G.value,o.value)},F=Object(s["ref"])(!1),H=Object(s["ref"])(""),Q=Object(s["ref"])(!1),J=Object(s["ref"])({name:"",price:0,mainImg:"",description:"",marketPrice:0,details:"",carouselImgs:[],detailImgs:[],state:"Public",qrCode:"",h5Link:"",lawyers:[]}),B=Object(s["ref"])(""),K=()=>{Q.value=!1,H.value=t.$t("goods.add"),J.value={...J.value,name:"",price:0,marketPrice:0,description:"",details:"",mainImg:"",carouselImgs:[],detailImgs:[],lawyers:[],state:"Public"},F.value=!0},W=async e=>{m["a"].show({message:t.$t("goods.uploading")});let a={};try{a=await Object(f["a"])(e.file),J.value.mainImg=a.fileUrl}catch(l){}return m["a"].hide(),a.fileUrl},X=async e=>{m["a"].show({message:t.$t("goods.uploading")});try{const t=await Object(f["a"])(e.file);return J.value.carouselImgs.push(t.fileUrl),m["a"].hide(),t.fileUrl}catch(a){}m["a"].hide()},Z=async e=>{m["a"].show({message:t.$t("goods.uploading")});try{const t=await Object(f["a"])(e.file);return J.value.detailImgs.push(t.fileUrl),m["a"].hide(),t.fileUrl}catch(a){}m["a"].hide()},ee=e=>{J.value.carouselImgs.splice(e,1)},te=e=>{J.value.detailImgs.splice(e,1)},ae=Object(s["ref"])(0),le=(e,a)=>{Q.value=!0,H.value=t.$t("People.edit");let l=[],o=[];a.carouselImgs&&(l=a.carouselImgs.split(",")),a.detailImgs&&(o=a.detailImgs.split(",")),J.value={name:a.name,price:a.price,mainImg:a.mainImg,description:a.description,marketPrice:a.marketPrice,details:a.details,state:a.state,h5Link:a.h5Link,qrCode:a.qrCode,lawyers:a.lawyers.map((e=>e.id)),carouselImgs:l,detailImgs:o},ae.value=a.id,F.value=!0},oe=Object(s["ref"])(null),se={name:[{required:!0,message:t.$t("goods.nameRequire"),trigger:"blur"}],price:[{required:!0,message:t.$t("goods.priceRequire"),trigger:"blur"}]},{mutate:ie}=Object(r["useMutation"])(g["b"]),{mutate:re}=Object(r["useMutation"])(g["g"]),{mutate:ce}=Object(r["useMutation"])(g["f"]),{mutate:ne}=Object(r["useMutation"])(g["e"]),de=()=>{oe.value&&oe.value.validate((async e=>{if(e){console.log(J.value);try{if(H.value==t.$t("goods.add")){const e={name:J.value.name,price:100*Number(J.value.price),mainImg:J.value.mainImg,description:J.value.description,marketPrice:100*Number(J.value.marketPrice),details:J.value.details,state:J.value.state,detailImgs:J.value.detailImgs.join(","),carouselImgs:J.value.carouselImgs.join(",")},a=await ie({commodity:e,lawyerIds:J.value.lawyers});console.log(a),L(),d["a"].success(t.$t("People.succeed"))}else{const e={name:J.value.name,price:100*Number(J.value.price),mainImg:J.value.mainImg,description:J.value.description,marketPrice:100*Number(J.value.marketPrice),details:J.value.details,state:J.value.state,detailImgs:J.value.detailImgs.join(","),carouselImgs:J.value.carouselImgs.join(",")},a=await M({commodity:e,id:ae.value,lawyerIds:J.value.lawyers});console.log(a),L(),d["a"].success(t.$t("People.succeed"))}F.value=!1,J.value={name:"",email:"",phone:"",avatarUrl:"https://file.sflow.pro/avatar_default.png",carouselImgs:[],detailImgs:[],lawyerIds:[],state:"Public"},console.log(J.value)}catch(a){d["a"].error(a.message)}}}))},ue=e=>{const t=/^(\d+)?(\.\d+)?$/;t.test(e)||(J.value.price=0)},me=e=>{switch(e){case"Release":return t.$t("Distributor.Officiallyreleased");case"Testing":return t.$t("Distributor.Internaltesting");case"Offline":return t.$t("Distributor.Offline")}},{mutate:pe}=Object(r["useMutation"])(g["c"]),ge=async(e,a)=>{u["a"].create({title:t.$t("People.confirm"),message:t.$t("action.delTipText"),ok:{label:t.$t("People.confirm"),noCaps:!0},cancel:{label:t.$t("People.cancel"),noCaps:!0,flat:!0},style:{zIndex:10002}}).onOk((async()=>{d["a"].success(t.$t("People.succeed")),await pe({id:a.id}),L(),d["a"].success(t.$t("People.succeed"))}))},be=async()=>{const e=await C({id:Number($.value),name:w.value});e&&(L(),R.value=!1,d["a"].success(t.$t("flow.CopySuccess")))},fe=async e=>{u["a"].create({title:t.$t("People.confirm"),message:"Release"==e.status?t.$t("goods.offlineTip"):t.$t("goods.releaseTip"),ok:{label:t.$t("People.confirm"),noCaps:!0},cancel:{label:t.$t("People.cancel"),noCaps:!0,flat:!0},style:{zIndex:10002}}).onOk((async()=>{let a;a="Release"==e.status?await ne({id:e.id}):await ce({id:e.id}),a&&(L(),d["a"].success(t.$t("notify.Done")))}))};return Object(s["onMounted"])((()=>{q(),L(),_()})),{TabelDate:o,searchValue:G,handleInputSearch:Y,handleInput:ue,formatterTime:E,beforeupload:W,formatterRole:A,roleOptions:N,isEdit:Q,dialogGoodVisible:F,projectDatas:c,createOrEditTitle:H,goodMessage:J,handleCopyGood:D,copyProjectId:I,copyname:w,currentUser:j,getallLawyer:q,allLawyer:U,goodRules:se,goodsurl:h,dialogCopyVisible:R,getStatus:me,goodForm:oe,handleCreate:K,handleEdit:le,handleDelete:ge,currlegalDocumentProjectId:B,handleSubmitMessage:de,loading:a,beforeuploadCarouselImgs:X,beforeuploadDetailImgs:Z,handleRemoveCarouselImg:ee,handleRemoveDetailImg:te,handleStatue:fe,handlecopy:T,handleDownload:z,copyProjectId:I,handleSubmitCopy:be}},methods:{handleSizeChange(e){this.pageSize=e},handleCurrentChange(e){this.currentPage=e}}}),I=$,j=(a("a0c4"),a("2877")),k=a("068f"),C=a("8f8e"),P=a("eebe"),x=a.n(P),M=Object(j["a"])(I,l,o,!1,null,"0c219d72",null);t["default"]=M.exports;x()(M,"components",{QImg:k["a"],QCheckbox:C["a"]})},a0c4:function(e,t,a){"use strict";a("68f2")}}]);