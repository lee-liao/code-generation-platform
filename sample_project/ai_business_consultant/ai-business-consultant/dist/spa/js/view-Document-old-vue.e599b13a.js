(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[16],{"0fe4":function(e,t,a){},3368:function(e,t,a){"use strict";a("0fe4")},"75a6":function(e,t,a){"use strict";a.r(t);var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"px-10 py-5"},[a("el-tabs",{staticClass:"mx-5 my-2",model:{value:e.activeName,callback:function(t){e.activeName=t},expression:"activeName"}},[a("el-tab-pane",{attrs:{label:e.$t("document.todo"),name:"1"}},[a("div",{staticStyle:{width:"100%",margin:"30px 0",display:"flex","justify-content":"space-between"}},[a("el-input",{staticStyle:{width:"200px"},attrs:{placeholder:e.$t("document.orderSearch")},model:{value:e.searchUnapprove,callback:function(t){e.searchUnapprove=t},expression:"searchUnapprove"}},[a("i",{staticClass:"el-input__icon el-icon-search",attrs:{slot:"prefix"},slot:"prefix"})])],1),a("el-table",{staticClass:"mb-5 ",staticStyle:{width:"100%"},attrs:{data:e.searchUnapprove?e.unApproveData.filter((function(t){return!e.searchUnapprove||t.wxPaidOrders.out_trade_no.toLowerCase().includes(e.searchUnapprove.toLowerCase())})):e.unApproveData.slice((e.currentPage1-1)*e.pageSize1,e.currentPage1*e.pageSize1),border:"","empty-text":e.$t("People.noData")}},[a("el-table-column",{attrs:{prop:"id",label:e.$t("document.user"),align:"center","min-width":"100%"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("div",{staticStyle:{width:"100%",display:"flex","align-items":"center","justify-content":"left","margin-left":"10px"}},[a("j-avatar",{staticClass:"shadow-outline-white -ml-1",attrs:{size:28,avatarUrl:t.row.wxUser.avatarUrl,name:"xxxxx"}}),a("span",{staticStyle:{"margin-left":"10px"}},[e._v(e._s(t.row.wxUser.name))])],1)]}}])}),a("el-table-column",{attrs:{prop:"name",label:e.$t("document.type"),align:"center","min-width":"100%"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n            "+e._s(t.row.legalDocumentProject.name)+"\n          ")]}}])}),a("el-table-column",{attrs:{prop:"out_trade_no",label:e.$t("document.orderNo"),align:"center","min-width":"100%"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n            "+e._s(t.row.wxPaidOrders.out_trade_no)+"\n          ")]}}])}),a("el-table-column",{attrs:{label:e.$t("People.action"),align:"center","min-width":"180%"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{type:"text"},on:{click:function(a){return e.handleApproval(t.row)}}},[e._v("\n              "+e._s(e.$t("document.Approval"))+"\n            ")]),a("el-button",{attrs:{type:"text"},on:{click:function(a){return e.handleChatHistory(t.row)}}},[e._v("\n              "+e._s(e.$t("Wxuser.chatHistory"))+"\n            ")])]}}])})],1),a("el-pagination",{attrs:{"current-page":e.currentPage1,"page-sizes":[5,10,20,50],"page-size":e.pageSize1,total:e.unApproveData.length,layout:"total, sizes, prev, pager, next, jumper"},on:{"size-change":e.handleSizeChange1,"current-change":e.handleCurrentChange1}})],1),a("el-tab-pane",{attrs:{label:e.$t("document.Completed"),name:"2"}},[a("div",{staticStyle:{width:"100%",margin:"30px 0",display:"flex","justify-content":"space-between"}},[a("el-input",{staticStyle:{width:"200px"},attrs:{placeholder:e.$t("document.orderSearch")},model:{value:e.searchApprove,callback:function(t){e.searchApprove=t},expression:"searchApprove"}},[a("i",{staticClass:"el-input__icon el-icon-search",attrs:{slot:"prefix"},slot:"prefix"})])],1),a("el-table",{staticClass:"mb-5 ",staticStyle:{width:"100%"},attrs:{data:e.searchApprove?e.approveData.filter((function(t){return!e.searchApprove||t.wxPaidOrders.out_trade_no.toLowerCase().includes(e.searchApprove.toLowerCase())})):e.approveData.slice((e.currentPage-1)*e.pageSize,e.currentPage*e.pageSize),border:"","empty-text":e.$t("People.noData")}},[a("el-table-column",{attrs:{prop:"id",label:e.$t("document.user"),align:"center","min-width":"100%"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("div",{staticStyle:{width:"100%",display:"flex","align-items":"center","justify-content":"left","margin-left":"10px"}},[a("j-avatar",{staticClass:"shadow-outline-white -ml-1",attrs:{size:28,avatarUrl:t.row.wxUser.avatarUrl,name:"xxxxx"}}),a("span",{staticStyle:{"margin-left":"10px"}},[e._v(e._s(t.row.wxUser.name))])],1)]}}])}),a("el-table-column",{attrs:{prop:"name",label:e.$t("document.type"),align:"center","min-width":"100%"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n            "+e._s(t.row.legalDocumentProject.name)+"\n          ")]}}])}),a("el-table-column",{attrs:{prop:"out_trade_no",label:e.$t("document.orderNo"),align:"center","min-width":"100%"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n            "+e._s(t.row.wxPaidOrders.out_trade_no)+"\n          ")]}}])}),a("el-table-column",{attrs:{label:e.$t("People.action"),align:"center","min-width":"180%"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{type:"text"},on:{click:function(a){return e.handleApprovedPreview(t.row)}}},[e._v("\n              "+e._s(e.$t("document.Preview"))+"\n            ")]),a("el-button",{attrs:{type:"text"},on:{click:function(a){return e.handleDownLoad(t.row)}}},[e._v("\n              "+e._s(e.$t("document.Download"))+"\n            ")]),a("el-button",{attrs:{type:"text"},on:{click:function(a){return e.handleReleaseDoucment(t.row)}}},[e._v(e._s(e.$t("document.Release")))])]}}])})],1),a("el-pagination",{attrs:{"current-page":e.currentPage,"page-sizes":[5,10,20,50],"page-size":e.pageSize,total:e.approveData.length,layout:"total, sizes, prev, pager, next, jumper"},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}})],1)],1),a("el-dialog",{attrs:{visible:e.chatHistoryDialogVisible,"close-on-click-modal":!1,width:"60%",center:""},on:{"update:visible":function(t){e.chatHistoryDialogVisible=t}}},e._l(e.chatHistory,(function(t){return a("div",{key:t.created,staticClass:"mt-3",staticStyle:{display:"flex"}},[a("div",{staticClass:"column"},[a("span",{staticClass:" mr-3",style:{whiteSpace:"nowrap",width:"250px",color:"#0747A6"}},[e._v(e._s("user"==t.role?e.$t("document.user"):"system"==t.role?e.$t("document.system"):e.$t("document.assistant"))+" "+e._s(e._f("formatDateTime")(t.created))+" :")]),a("span",[e._v(" "+e._s(t.content))])])])})),0),a("el-dialog",{attrs:{visible:e.preivewDialogVisible,"close-on-click-modal":!1,width:"60%",center:""},on:{"update:visible":function(t){e.preivewDialogVisible=t}}},[a("div",{domProps:{innerHTML:e._s(e.convertedContent)}})]),a("el-dialog",{staticClass:"custom-dialog",attrs:{visible:e.centerDialogVisible,"close-on-click-modal":!1,fullscreen:"","show-close":!1,width:"30%",center:""},on:{"update:visible":function(t){e.centerDialogVisible=t}}},[a("div",{staticClass:"row "},[a("div",{staticClass:"column ",staticStyle:{width:"48%"}},[a("span",[e._v(e._s(e.$t("document.Element")))]),a("json-viewer",{staticClass:"w-100% mt-1 ml-3",staticStyle:{"box-shadow":"0 0 8px rgba(0, 0, 0, 0.1)"},attrs:{value:e.itemData.dataJson,"expand-depth":5,boxed:"",expanded:""}})],1),a("div",{staticClass:"column ml-5",staticStyle:{width:"48%","min-height":"580px"}},[a("span",[e._v(e._s(e.$t("document.Document")))]),a("div",{staticClass:"border-box mt-1 px-3 py-3"},e._l(e.elements,(function(t){return a("div",{key:t.label,staticClass:"mt-3",staticStyle:{display:"flex"}},[a("span",{staticClass:"mt-3 mr-3",style:{whiteSpace:"nowrap",width:"100px"}},[e._v(e._s(t.label))]),a("el-input",{attrs:{type:"textarea",rows:3},model:{value:t.value,callback:function(a){e.$set(t,"value",a)},expression:"item.value"}})],1)})),0)])]),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{type:"primary"},on:{click:function(t){e.centerDialogVisible=!1}}},[e._v(e._s(e.$t("document.Back")))]),a("el-button",{on:{click:e.exportWord}},[e._v("\n        "+e._s(e.$t("document.Download"))+"\n      ")]),a("el-button",{on:{click:e.handlePreview}},[e._v("\n        "+e._s(e.$t("document.Preview"))+"\n      ")]),a("el-button",{on:{click:e.handleSave}},[e._v(e._s(e.$t("document.Save")))]),a("el-button",{attrs:{type:"primary"},on:{click:e.handleRelease}},[e._v(e._s(e.$t("document.Release")))])],1)]),a("el-dialog",{attrs:{width:"70%","close-on-click-modal":!1,visible:e.previewDialog,"modal-append-to-body":!1,"destroy-on-close":!0},on:{"update:visible":function(t){e.previewDialog=t}}},[a("div",{staticClass:"column items-center"},[a("iframe",{attrs:{src:"https://view.officeapps.live.com/op/view.aspx?src="+e.itemData.fileUrl,width:"100%",height:"700px"}})])])],1)},o=[],l=(a("ddb0"),a("2b3d"),a("9861"),a("5319"),a("caad"),a("5b81"),a("750b")),r=(a("ac79"),a("1840")),s=a("6560"),i=(a("db56"),a("6eb7")),c=a("b850"),u=(a("fbf9"),a("c4e3"),a("0083"),a("8ee3"),a("c343")),d=a.n(u),p=(a("21a6"),a("281c"),a("f526")),v=a("fadb"),m=Object(l["defineComponent"])({name:"Login",components:{},data(){return{currentPage:1,pageSize:5,currentPage1:1,pageSize1:5}},mounted(){Object(v["b"])(this,"isMobile")},setup(e,{root:t}){const a=Object(l["ref"])([]),{mutate:n}=Object(r["useMutation"])(s["c"]),{mutate:o}=Object(r["useMutation"])(s["h"]),{mutate:u}=Object(r["useMutation"])(s["e"]),v=Object(l["ref"])(""),m=Object(l["ref"])(""),h=async e=>{fetch(e.fileUrl).then((t=>{t.blob().then((t=>{const a=window.URL.createObjectURL(t),n=document.createElement("a");n.href=a,n.download=e.legalDocumentProject.name+"_"+e.wxPaidOrders.out_trade_no+".docx",n.click(),window.URL.revokeObjectURL(a)}))}))},f=Object(l["ref"])(!1),w=Object(l["ref"])(!1),b=Object(l["ref"])(!1),g=Object(l["ref"])(""),_={id:0,docJson:"",chatJson:"",dataJson:"",reviewDocJson:"",openid:"",fileUrl:"",projectName:"",out_trade_no:""},y=()=>{Object(p["a"])(_.fileUrl,""==_.reviewDocJson?_.docJson:_.reviewDocJson,_.projectName+"_"+_.out_trade_no+".docx")},x=Object(l["ref"])(!1),D=async()=>{const e={};H.value.forEach(((t,a)=>{e[`${t.label}`]=t.value}));const a={reviewDocJson:JSON.stringify(e)},n=await o({paperwork:a,id:_.id});n&&i["a"].success(t.$t("notify.Done"))},S=Object(l["ref"])([]),C=async()=>{const e={};H.value.forEach(((t,a)=>{e[`${t.label}`]=t.value}));const a={reviewDocJson:JSON.stringify(e)},n=await o({paperwork:a,id:_.id});if(n){const e=await u({id:_.id});e&&(i["a"].success(t.$t("document.ReleaseSuccess")),J(),f.value=!1)}},j=async e=>{const a=await u({id:e.id});a&&(i["a"].success(t.$t("document.ReleaseSuccess")),J(),f.value=!1)},J=async()=>{const e=await n();if(e){const t=e.data.getPaperworks;k.value=t.filter((e=>"approved"===e.state)),P.value=t.filter((e=>"unapproved"===e.state))}},O=async()=>{H.value.forEach((e=>{g.value=g.value.replace("{"+e.label+"}",e.value)})),w.value=!0},$=e=>{_.fileUrl=e.fileUrl,b.value=!0},k=Object(l["ref"])([]),P=Object(l["ref"])([]),U=e=>{let t={};for(const a in e)if("object"===typeof e[a]&&null!==e[a]){const n=e[a];for(const e in n)t[`${e}`]=n[e]}else t[a]=e[a];return t},A=()=>{P.value=P.value.filter((e=>(console.log("1111111111111",e),e.wxPaidOrders.out_trade_no.includes(v.value))))},z=()=>{k.value=k.value.filter((e=>e.wxPaidOrders.out_trade_no.includes(m.value)))},N=e=>{if(console.log("------------handleApproval=",e),H.value=[],_.id=e.id,_.projectName=e.legalDocumentProject.name,_.out_trade_no=e.wxPaidOrders.out_trade_no,_.chatJson=e.chatJson,_.openid=e.wxUser.openId,_.fileUrl=e.legalDocumentProject.legalDocumentTemplates[0].fileUrl,_.dataJson=null==e.dataJson?"":JSON.parse(e.dataJson.replaceAll(/\n/g,"\\n").replaceAll(/\r/g,"\\r")),_.docJson=null==e.docJson?"":JSON.parse(e.docJson.replaceAll(/\n/g,"\\n").replaceAll(/\r/g,"\\r")),_.reviewDocJson=null==e.reviewDocJson?"":JSON.parse(e.reviewDocJson.replaceAll(/\n/g,"\\n").replaceAll(/\r/g,"\\r")),_.reviewDocJson=U(_.reviewDocJson),f.value=!0,V(_.fileUrl),e.reviewDocJson)if(_.reviewDocJson)for(let t in _.reviewDocJson){let e={label:t,value:_.reviewDocJson[t]};H.value.push(e)}else H.value=[];else if(_.docJson)for(let t in _.docJson){let e={label:t,value:_.docJson[t]};H.value.push(e)}else H.value=[]},L=Object(l["ref"])([]),R=e=>{L.value=[],_.chatJson=e.chatJson,null!=_.chatJson&&(L.value=JSON.parse(_.chatJson.replaceAll(/\n/g,"\\n").replaceAll(/\r/g,"\\r"))),x.value=!0},H=Object(l["ref"])([]),V=e=>{fetch(e).then((e=>e.arrayBuffer())).then((e=>d.a.convertToHtml({arrayBuffer:e}))).then((e=>{g.value=e.value})).catch((e=>{console.error(e)}))};return Object(l["onMounted"])((()=>{const e=Object(l["computed"])(c["b"].currentUser);1!=e.value.role&&2!=e.value.role?t.$router.push("/workflow"):J()})),{activeName:"1",handleApproval:N,approveData:k,searchUnapprove:v,searchApprove:m,unApproveData:P,handleUnapprove:A,handleApprove:z,unApprovetableData:S,chatHistoryDialogVisible:x,handleChatHistory:R,handleApprovedPreview:$,previewDialog:b,chatHistory:L,elements:H,handleSave:D,handlePreview:O,tableData:a,exportWord:y,handleDownLoad:h,handleRelease:C,handleReleaseDoucment:j,preivewDialogVisible:w,loadAndConvertDocument:V,convertedContent:g,centerDialogVisible:f,itemData:_}},methods:{handleSizeChange(e){this.pageSize=e},handleCurrentChange(e){this.currentPage=e},handleSizeChange1(e){this.pageSize1=e},handleCurrentChange1(e){this.currentPage1=e}}}),h=m,f=(a("3368"),a("2877")),w=Object(f["a"])(h,n,o,!1,null,"7fe011c2",null);t["default"]=w.exports}}]);