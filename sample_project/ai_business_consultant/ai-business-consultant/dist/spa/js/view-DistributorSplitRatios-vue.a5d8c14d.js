(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[15],{"283e":function(e,t,a){},"47aa":function(e,t,a){"use strict";a.r(t);var l=function(){var e=this,t=e.$createElement,l=e._self._c||t;return l("div",{staticClass:"w-full h-full px-12"},[l("div",{staticClass:"mx-3 my-3 cursor-pointer items-center flex",on:{click:function(t){return e.goOff()}}},[l("img",{staticStyle:{float:"left",width:"22px"},attrs:{src:a("b6bc")}}),l("span",[e._v(" "+e._s(e.$t("mainlayout.DistributorSplitRatios")))])]),l("div",{staticStyle:{width:"100%",margin:"15px 0",display:"flex","justify-content":"space-between"}},[l("el-input",{staticStyle:{width:"200px"},attrs:{placeholder:e.$t("People.searchForName")},on:{input:e.handleInputSearch},model:{value:e.searchValue,callback:function(t){e.searchValue=t},expression:"searchValue"}},[l("i",{staticClass:"el-input__icon el-icon-search",attrs:{slot:"prefix"},slot:"prefix"})]),1==e.currentUser.role?l("el-button",{attrs:{type:"primary"},on:{click:e.handleCreate}},[e._v("\n      "+e._s(e.$t("DistributorSplitRatio.addSplitRatio"))+"\n    ")]):e._e()],1),l("div",[l("el-table",{staticClass:"mb-5",staticStyle:{width:"100%"},attrs:{data:e.tableData.slice((e.currentPage-1)*e.pageSize,e.currentPage*e.pageSize),border:"",loading:e.Loading,"empty-text":e.$t("People.noData")}},[l("el-table-column",{attrs:{label:e.$t("DistributorSplitRatio.name"),align:"center","min-width":"100%"},scopedSlots:e._u([{key:"default",fn:function(t){return[l("div",{staticStyle:{width:"100%",display:"flex","align-items":"center","justify-content":"left","margin-left":"10px"}},[l("span",{staticStyle:{"margin-left":"10px"}},[e._v(e._s(t.row.name))])])]}}])}),l("el-table-column",{attrs:{prop:"desc",label:e.$t("DistributorSplitRatio.divideinto"),align:"center","min-width":"130%"},scopedSlots:e._u([{key:"default",fn:function(t){return[l("el-table",{staticClass:"mb-5",staticStyle:{width:"100%"},attrs:{data:JSON.parse(t.row.ratioJson),border:"",loading:e.Loading,"empty-text":e.$t("People.noData")}},[l("el-table-column",{attrs:{label:"金额",align:"center","min-width":"100%"},scopedSlots:e._u([{key:"default",fn:function(t){return[l("span",{staticStyle:{"margin-left":"10px"}},[e._v("≥"+e._s(t.row.amount))])]}}],null,!0)}),l("el-table-column",{attrs:{label:"分成",align:"center","min-width":"100%"},scopedSlots:e._u([{key:"default",fn:function(t){return[l("span",{staticStyle:{"margin-left":"10px"}},[e._v(e._s(t.row.splitRatio)+"%")])]}}],null,!0)})],1)]}}])}),1==e.currentUser.role?l("el-table-column",{attrs:{label:e.$t("People.action"),align:"center","min-width":"100%"},scopedSlots:e._u([{key:"default",fn:function(t){return[l("el-button",{attrs:{type:"text"},on:{click:function(a){return e.handleEdit(t.$index,t.row)}}},[e._v("\n            "+e._s(e.$t("People.edit"))+"\n          ")]),l("el-button",{attrs:{type:"text"},on:{click:function(a){return e.handleDelete(t.$index,t.row)}}},[e._v("\n            "+e._s(e.$t("People.delete"))+"\n          ")])]}}],null,!1,3061837012)}):e._e()],1),l("el-pagination",{attrs:{"current-page":e.currentPage,"page-sizes":[5,10,20,50],"page-size":e.pageSize,total:e.tableData.length,layout:"total, sizes, prev, pager, next, jumper"},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}})],1),l("el-dialog",{staticClass:"channel-dialog",attrs:{"close-on-click-modal":!1,visible:e.dialogPeopleVisible,title:e.createOrEditTitle,width:e.isMobile?"calc(100vw - 54px)":"calc(55% - 260px)","append-to-body":!0},on:{"update:visible":function(t){e.dialogPeopleVisible=t}}},[l("el-form",{ref:"peopleForm",attrs:{model:e.distributorInfo,"label-width":"80px","label-position":"top"}},[l("el-form-item",{attrs:{label:e.$t("DistributorSplitRatio.name"),prop:"name"}},[l("el-input",{staticClass:"channel-input",attrs:{"validate-event":!1,autocomplete:"off"},model:{value:e.distributorInfo.name,callback:function(t){e.$set(e.distributorInfo,"name",t)},expression:"distributorInfo.name"}})],1),l("el-form-item",{attrs:{label:e.$t("DistributorSplitRatio.divideinto"),prop:"describe"}},[l("div",{staticClass:"mt-3 mb-3"},[l("q-btn",{staticClass:"ml-2",attrs:{round:"",color:"primary",size:"small",icon:"add"},on:{click:e.addFormData}}),l("div",{staticClass:"contact-form-part"},e._l(e.formData,(function(t,a){return l("div",{key:a,staticClass:"mt-3"},[l("div",{staticClass:"row"},[l("span",{staticClass:"ml-2 mr-2"},[e._v("≥")]),l("el-input",{staticStyle:{width:"150px"},attrs:{autocomplete:"off"},model:{value:t.amount,callback:function(a){e.$set(t,"amount",a)},expression:"field.amount"}}),l("span",{staticClass:"ml-2 mr-2"},[e._v("分成")]),l("el-input",{staticClass:"ml-2 mr-2 right-align-input",staticStyle:{width:"150px","text-align":"right"},attrs:{autocomplete:"off"},model:{value:t.splitRatio,callback:function(a){e.$set(t,"splitRatio",a)},expression:"field.splitRatio"}}),e._v("\n                %\n                "),l("span",{staticClass:"form-del",on:{click:function(t){return e.formDel(a)}}},[e._v(e._s(e.$t("action.delete")))])],1)])})),0)],1)])],1),l("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[l("el-button",{on:{click:function(t){e.dialogPeopleVisible=!1}}},[e._v(e._s(e.$t("People.cancel")))]),l("el-button",{attrs:{type:"primary"},on:{click:e.handleSubmitMessage}},[e._v(e._s(e.$t("People.confirm")))])],1)],1)],1)},i=[],o=a("750b"),n=a("b850"),s=a("1840"),r=a("5a0c"),c=a.n(r),u=a("6eb7"),p=a("436b"),d=a("159f"),m=a("fadb"),b=Object(o["defineComponent"])({data(){return{isMobile:Object(m["a"])()}},mounted(){Object(m["b"])(this,"isMobile")},setup(e,{root:t}){const a=Object(o["ref"])(!1),l=Object(o["ref"])([]),i=Object(o["computed"])(n["b"].currentUser),r=Object(o["ref"])([]),{mutate:m}=Object(s["useMutation"])(d["c"]),b=()=>{v.value.push({id:v.value.length+1+"",amount:"",splitRatio:"",type:"textarea"})},f=e=>{v.value.splice(e,1)},v=Object(o["ref"])([]),g=async()=>{try{a.value=!0;const{data:{getOrgDistributorSplitRatios:e}}=await m();l.value=e,r.value=e,a.value=!1,console.log(r.value)}catch(e){console.log("----------getPeople error")}},h=(e,t="YYYY/MM/DD  HH:mm:ss")=>e?c()(e).format(t):e,$=e=>{let t=h(e.createdAt);return t},y=e=>{switch(e.role){case 1:return t.$t("People.Administrators");case 2:return t.$t("People.Lawyer");case 3:return t.$t("People.Operator");case 4:return t.$t("People.Finance");case 5:return t.$t("People.Distributor");case 6:return t.$t("People.DistributorAdmin")}},S=[{value:1,label:t.$t("People.Administrators")},{value:2,label:t.$t("People.Lawyer")},{value:3,label:t.$t("People.Operator")},{value:4,label:t.$t("People.Finance")},{value:5,label:t.$t("People.Distributor")},{value:6,label:t.$t("People.DistributorAdmin")}],P=Object(o["ref"])(""),w=()=>{r.value=l.value.filter((e=>e.name.includes(P.value))),console.log(P.value,r.value)},_=Object(o["ref"])(!1),x=Object(o["ref"])(""),O=Object(o["ref"])({name:"",desc:""}),D=()=>{x.value=t.$t("People.add"),O.value={...O.value,name:"",desc:""},_.value=!0},C=Object(o["ref"])(""),j=(e,a)=>{x.value=t.$t("People.edit"),v.value=JSON.parse(a.ratioJson),O.value={name:a.name},C.value=a.id,console.log(C.value),_.value=!0},k=Object(o["ref"])(null),R={name:[{required:!0,message:t.$t("Distributor.DistributorMessage"),trigger:"blur"}]},{mutate:M}=Object(s["useMutation"])(d["a"]),{mutate:z}=Object(s["useMutation"])(d["d"]),I=()=>{k.value&&k.value.validate((async e=>{if(e){let e=[];v.value.forEach((t=>{let a={amount:t.amount,splitRatio:t.splitRatio};e.push(a)}));const l={name:O.value.name,ratioJson:JSON.stringify(e)};try{if(x.value==t.$t("People.add")){const e=await M({distributorSplitRatio:l});console.log(e),g(),u["a"].success(t.$t("People.succeed"))}else{const e=await z({distributorSplitRatio:l,id:C.value});console.log(e),g(),u["a"].success(t.$t("People.succeed"))}_.value=!1,O.value={name:""},v.value=[],console.log(O.value)}catch(a){u["a"].error(a.message)}}}))},{mutate:J}=Object(s["useMutation"])(d["b"]),V=async(e,a)=>{p["a"].create({title:t.$t("People.confirm"),message:t.$t("DistributorSplitRatio.confirmDelete"),ok:{label:t.$t("People.confirm"),noCaps:!0},cancel:{label:t.$t("People.cancel"),noCaps:!0,flat:!0},style:{zIndex:10002}}).onOk((async()=>{u["a"].success(t.$t("People.succeed")),await J({id:a.id}),g(),u["a"].success(t.$t("People.succeed"))}))},F=Object(o["ref"])(1),E=Object(o["ref"])(10),A=e=>{E.value=e},L=()=>{t.$router.go(-1)},N=e=>{F.value=e};return Object(o["onMounted"])((()=>{g()})),{tableData:r,searchValue:P,handleInputSearch:w,currentPage:F,pageSize:E,addFormData:b,formData:v,formDel:f,handleSizeChange:A,handleCurrentChange:N,formatterTime:$,formatterRole:y,currentUser:i,roleOptions:S,dialogPeopleVisible:_,createOrEditTitle:x,distributorInfo:O,peopleRules:R,peopleForm:k,handleCreate:D,handleEdit:j,handleDelete:V,handleSubmitMessage:I,Loading:a,goOff:L}}}),f=b,v=(a("75a2"),a("2877")),g=a("9c40"),h=a("eebe"),$=a.n(h),y=Object(v["a"])(f,l,i,!1,null,"158384c0",null);t["default"]=y.exports;$()(y,"components",{QBtn:g["a"]})},"75a2":function(e,t,a){"use strict";a("283e")}}]);