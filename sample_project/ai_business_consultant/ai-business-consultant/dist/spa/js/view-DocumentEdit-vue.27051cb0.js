(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[18],{"195c":function(e,t,a){},dde8:function(e,t,a){"use strict";a("195c")},e42b:function(e,t,a){"use strict";a.r(t);var o=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"px-3 py-3",staticStyle:{display:"flex","flex-direction":"column","justify-content":"center","align-items":"center"}},[a("div",{staticClass:"flex-container"},[a("div",{staticClass:"column left-panel"},[a("el-tabs",{staticClass:"mx-5",model:{value:e.activeName,callback:function(t){e.activeName=t},expression:"activeName"}},[a("el-tab-pane",{attrs:{label:e.$t("document.inUserElement"),name:"1"}},[a("json-viewer",{staticClass:"w-100% mt-1 ml-3",staticStyle:{"box-shadow":"0 0 8px rgba(0, 0, 0, 0.1)",height:"70vh","overflow-y":"auto"},attrs:{value:e.itemData.docJson,"expand-depth":5,boxed:"",expanded:""}})],1),a("el-tab-pane",{attrs:{label:e.$t("Wxuser.chatHistory"),name:"2"}},[a("div",{staticClass:"border-box mt-1 px-3 py-3",staticStyle:{height:"70vh","overflow-y":"auto"}},e._l(e.chatHistory,(function(t){return a("div",{key:t.created,staticClass:"mt-3",staticStyle:{display:"flex"}},[a("div",{staticClass:"column w-full"},[a("span",{staticClass:"mr-3",style:{whiteSpace:"nowrap",width:"250px",color:"#0747A6"}},[e._v(e._s("user"==t.role?e.$t("document.user"):"system"==t.role?e.$t("document.system"):e.$t("document.assistant"))+"\n                  "+e._s(e._f("formatDateTime")(t.created))+" :")]),"user"!=t.role?a("vue-markdown",{staticClass:"px-1 py-1",style:"user"==t.role?" background: rgb(102, 177, 255) ;":";background: #DCDFE6;",attrs:{source:t.content}}):e._e(),"user"==t.role?a("span",{staticClass:"px-1 py-1",style:"user"==t.role?" background: rgb(102, 177, 255) ;":"background: #DCDFE6;"},[e._v("\n                  "+e._s(t.content))]):e._e()],1)])})),0)]),a("el-tab-pane",{attrs:{label:e.$t("document.caseElement"),name:"3"}},[a("div",{staticStyle:{height:"70vh","overflow-y":"auto"}},e._l(e.treeData,(function(t){return a("div",{key:t.label},[a("span",{staticClass:"cursor-pointer",staticStyle:{background:"rgb(102, 177, 255)"},on:{click:function(a){return e.handleElementClick(t)}}},[e._v("\n                - "+e._s(t.label))]),e._l(t.children,(function(t){return a("div",{key:t.label},[a("span",{staticClass:"ml-3"},[e._v(" - "+e._s(t.label))])])}))],2)})),0)])],1)],1),e._m(0)]),a("span",{staticClass:"dialog-footer mt-2",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{type:"primary"},on:{click:e.handleBack}},[e._v(e._s(e.$t("document.Back")))]),a("el-button",{attrs:{type:"primary"},on:{click:e.handleRelease}},[e._v(e._s(e.$t("document.Release")))])],1)])},n=[function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"column ml-5 mt-3 right-panel",staticStyle:{width:"100%"}},[a("div",{staticClass:"border-box mt-1 px-3 py-3"},[a("div",{staticStyle:{height:"72vh","overflow-y":"auto"},attrs:{id:"container"}})])])}],l=(a("5319"),a("5b81"),a("750b")),c=(a("ac79"),a("1840")),s=(a("1f2a"),a("6560")),r=(a("db56"),a("6eb7")),i=a("b850"),u=a("9ce6"),d=a.n(u),p=a("fadb"),m=Object(l["defineComponent"])({name:"Login",components:{VueMarkdown:d.a},data(){return{isPwd:!0,isNetWrok:!0,isMobile:Object(p["a"])()}},mounted(){Object(p["b"])(this,"isMobile")},setup(e,{root:t}){Object(l["computed"])(i["b"].currentUser);const{mutate:a}=Object(c["useMutation"])(s["b"]),{mutate:o}=Object(c["useMutation"])(s["f"]),{mutate:n}=Object(c["useMutation"])(s["g"]),{id:u}=t.$route.params,{mutate:d}=Object(c["useMutation"])(s["a"]),p=Object(l["ref"])([]),m=async()=>{const e=k.Application;e.ActiveDocument.Save();const a=await n({id:Number(u)});a&&r["a"].success(t.$t("document.ReleaseSuccess"))},b=()=>{t.$router.push("/document")},f=e=>{console.log("Node clicked:",e)},v={id:0,docJson:"",chatJson:"",dataJson:"",reviewDocJson:"",openid:"",fileUrl:"",projectName:"",out_trade_no:"",chatHistory:p},h=async(e,t)=>{await o({accessToken:e,refreshToken:t})},y=Object(l["ref"])("1"),g=e=>{console.log("Node clicked:",e),y.value="2",x(e.trace)};let k=null;const w=async e=>{const t=await a({id:e});if(t){const e=JSON.parse(t.data.getPaperworkGenerateWebofficeToken);let a=document.querySelector("#container");k=aliyun.config({mount:a,url:e.WebofficeURL,refreshToken:h(e.AccessToken,e.RefreshToken)}),k.setToken({token:e.AccessToken}),k.on("fileOpen",(async function(e){await k.ready();const t=k.Application;t.ActiveDocument.ActiveWindow.View.Zoom.Percentage=95,console.log(e)})),k.on("error",(e=>{console.log("发生错误：",e)}))}},x=e=>{let a=1/0,o=-1;for(let t=0;t<p.value.length;t++){const n=e-p.value[t].created;console.log(n),n>=0&&n<a&&(a=n,o=t)}-1!==o&&t.$nextTick((()=>{const e=document.querySelectorAll("span");console.log("11111111111",e,o),e[55+o].scrollIntoView({behavior:"smooth",block:"start"})}))},J=Object(l["ref"])([]),_=Object(l["ref"])([]),C=e=>{let t=[];for(let n in e)if("trace"!==n)if("object"!==typeof e[n]||Array.isArray(e[n])){if("string"===typeof e[n]){var a;t.push({label:n,trace:null===(a=e["trace"])||void 0===a?void 0:a[n],children:[{label:e[n],children:[]}]})}}else{var o;let a=[];for(let t in e[n])e[n].hasOwnProperty(t)&&a.push({label:`${t}: ${e[n][t]}`});t.push({label:n,trace:null===(o=e["trace"])||void 0===o?void 0:o[n],children:a})}else _.value=e["trace"];J.value=t},O=async()=>{const{data:e}=await d({id:Number(u)}),t=e.getPaperworkById;v.id=t.id,v.projectName=t.legalDocumentProject.name,v.out_trade_no=t.wxPaidOrders.out_trade_no,v.chatJson=t.chatJson,v.openid=t.wxUser.openId,v.fileUrl=t.legalDocumentProject.legalDocumentTemplates[0].fileUrl,v.dataJson=null==t.dataJson?"":JSON.parse(t.dataJson.replace(/[\x00-\x1F\x7F]/g,"").replaceAll(/\n/g,"\\n").replaceAll(/\r/g,"\\r")),console.log(v.dataJson),v.docJson=null==t.docJson?"":JSON.parse(t.docJson.replace(/[\x00-\x1F\x7F]/g,"").replaceAll(/\n/g,"\\n").replaceAll(/\r/g,"\\r")),v.reviewDocJson=null==t.reviewDocJson?"":JSON.parse(t.reviewDocJson.replace(/[\x00-\x1F\x7F]/g,"").replaceAll(/\n/g,"\\n").replaceAll(/\r/g,"\\r")),p.value=[],v.chatJson=t.chatJson,null!=v.chatJson&&(p.value=JSON.parse(v.chatJson.replace(/[\x00-\x1F\x7F]/g,"").replaceAll(/\n/g,"\\n").replaceAll(/\r/g,"\\r"))),console.log(v.dataJson),C(v.dataJson),w(Number(u))};return Object(l["onMounted"])((()=>{O()})),{itemData:v,chatHistory:p,handleBack:b,handleRelease:m,activeName:y,treeData:J,handleSearch:x,getPaperworkInfo:O,onNodeClick:f,handleElementClick:g}}}),b=m,f=(a("dde8"),a("2877")),v=a("7f41"),h=a("eebe"),y=a.n(h),g=Object(f["a"])(b,o,n,!1,null,"1c84cff2",null);t["default"]=g.exports;y()(g,"components",{QTree:v["a"]})}}]);