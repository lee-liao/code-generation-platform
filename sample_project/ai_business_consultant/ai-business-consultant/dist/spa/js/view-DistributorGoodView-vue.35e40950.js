(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[12],{"8e52":function(e,t,a){"use strict";a.r(t);var r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"w-full h-full px-12"},[a("div",{staticStyle:{width:"100%",margin:"20px 0",display:"flex","justify-content":"space-between"}},[a("el-input",{staticStyle:{width:"200px"},attrs:{placeholder:e.$t("People.searchForName")},on:{input:e.handleInputSearch},model:{value:e.searchValue,callback:function(t){e.searchValue=t},expression:"searchValue"}},[a("i",{staticClass:"el-input__icon el-icon-search",attrs:{slot:"prefix"},slot:"prefix"})])],1),a("div",{staticStyle:{margin:"20px 0"}},[a("div",[a("el-table",{staticClass:"mb-5",staticStyle:{width:"100%"},attrs:{data:e.TabelDate.slice((e.currentPage-1)*e.pageSize,e.currentPage*e.pageSize),border:"",loading:e.loading,"empty-text":e.$t("People.noData")}},[a("el-table-column",{attrs:{prop:"name",label:e.$t("goods.name"),align:"center","min-width":"100%"}}),a("el-table-column",{attrs:{label:e.$t("goods.mainImg"),align:"center","min-width":"100%"},scopedSlots:e._u([{key:"default",fn:function(t){return[t.row.mainImg?a("el-image",{staticStyle:{width:"60px",height:"60px"},attrs:{src:t.row.mainImg,fit:e.fit}}):e._e()]}}])}),a("el-table-column",{attrs:{label:e.$t("goods.projectType"),align:"center","min-width":"100%"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n            "+e._s(null!=t.row.legalDocumentProject?t.row.legalDocumentProject.name:e.$t("Distributor.legaladvice"))+"\n          ")]}}])}),a("el-table-column",{attrs:{prop:"status",label:e.$t("goods.status"),align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n            "+e._s(e.getStatus(t.row.status))+"\n          ")]}}])}),a("el-table-column",{attrs:{prop:"price",label:e.$t("goods.price"),align:"center"}}),a("el-table-column",{attrs:{prop:"description",label:e.$t("goods.description"),align:"center"}}),a("el-table-column",{attrs:{prop:"createdAt",label:e.$t("goods.createdAt"),align:"center",formatter:e.formatterTime}}),a("el-table-column",{attrs:{prop:"updatedAt",label:e.$t("goods.updatedAt"),align:"center",formatter:e.formatterTime}}),6==e.currentUser.role&&1==e.currentUser.organizationId?a("el-table-column",{attrs:{label:e.$t("People.action"),align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{disabled:!(6==e.currentUser.role&&1==e.currentUser.organizationId),type:"text"},on:{click:function(a){return e.handleBuyGood(t.row)}}},[e._v(e._s(e.$t("Distributor.purchase")))])]}}],null,!1,1953294627)}):e._e()],1),a("el-pagination",{attrs:{"current-page":e.currentPage,"page-sizes":[5,10,20,50],"page-size":e.pageSize,total:e.TabelDate.length,layout:"total, sizes, prev, pager, next, jumper",locale:e.customLocale},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}})],1)]),a("el-dialog",{attrs:{"close-on-click-modal":!1,visible:e.buyGoodDialog,title:e.$t("Distributor.Purchaseproducts"),center:"",width:"30%"},on:{"update:visible":function(t){e.buyGoodDialog=t}}},[a("div",[a("el-form",{ref:"buyGoodFormRef",attrs:{model:e.buyGoodMessage,rules:e.buyGoodRules,"label-width":"150px"}},[a("el-form-item",{attrs:{label:e.$t("Distributor.OrganizationName"),prop:"orgId"}},[a("el-select",{staticStyle:{width:"100%"},attrs:{clearable:"",filterable:"",placeholder:e.$t("People.PleaseSelect")},model:{value:e.buyGoodMessage.orgId,callback:function(t){e.$set(e.buyGoodMessage,"orgId",t)},expression:"buyGoodMessage.orgId"}},e._l(e.AllOrgData,(function(e){return a("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})})),1)],1),a("el-form-item",{attrs:{label:e.$t("goods.stock"),prop:"stock"}},[a("el-input",{model:{value:e.buyGoodMessage.stock,callback:function(t){e.$set(e.buyGoodMessage,"stock",t)},expression:"buyGoodMessage.stock"}})],1)],1)],1),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.buyGoodDialog=!1}}},[e._v(e._s(e.$t("People.cancel")))]),a("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.ComfirmBuyGoods()}}},[e._v(e._s(e.$t("People.confirm")))])],1)])],1)},o=[],l=(a("caad"),a("750b")),n=a("b850"),s=a("1840"),i=a("45c1"),c=a("fadb"),u=a("5a0c"),d=a.n(u),g=a("6eb7"),b=Object(l["defineComponent"])({data(){return{isMobile:Object(c["a"])(),currentPage:1,pageSize:10,customLocale:{prev:"Previous",next:"Next",pager:"Page"}}},mounted(){Object(c["b"])(this,"isMobile")},setup(e,{root:t}){const a=Object(l["ref"])(!1),r=Object(l["ref"])([]),o=Object(l["ref"])([]),c=Object(l["computed"])(n["b"].currentUser),{mutate:u}=Object(s["useMutation"])(i["m"]),{mutate:b}=Object(s["useMutation"])(i["f"]),{mutate:p}=Object(s["useMutation"])(i["e"]),m=e=>{switch(e){case"Release":return t.$t("Distributor.Officiallyreleased");case"Testing":return t.$t("Distributor.Internaltesting");case"Offline":return t.$t("Distributor.Offline")}},f=async()=>{try{a.value=!0;const{data:{getSellDistributorCommoditys:e}}=await u();e.forEach((e=>{e.price=e.price/100,e.marketPrice=e.marketPrice/100})),o.value=e,r.value=e,a.value=!1,console.log(r.value)}catch(e){console.log("----------getGoods error")}},h=Object(l["ref"])([]),y=async()=>{try{const{data:{getAllOrganizations:e}}=await b();h.value=e}catch(e){console.log("----------getDistributors error")}},v=(e,t="YYYY/MM/DD  HH:mm:ss")=>e?d()(e).format(t):e,$=e=>{let t=v(e.createdAt);return t},w=Object(l["ref"])(""),D=()=>{r.value=o.value.filter((e=>e.name.includes(w.value))),console.log(w.value,r.value)},k=Object(l["ref"])(!1),O=Object(l["ref"])({orgId:"",stock:1}),S={orgId:[{required:!0,message:t.$t("Distributor.Pleaseselectanorganization"),trigger:"blur"}],stock:[{required:!0,message:t.$t("Distributor.Pleaseenterandfillininventory"),trigger:"blur"}]},j=Object(l["ref"])(null),P=async e=>{k.value=!0,j.value=Number(e.id)},_=async()=>{if(""==O.value.orgId)return g["a"].error(t.$t("Distributor.Youmustchooseanorganization"));if(0==O.value.stock)return g["a"].error(t.$t("Distributor.Thepurchasedinventorycannot"));try{await p({commodityId:Number(j.value),stock:Number(O.value.stock),orgId:Number(O.value.orgId)});g["a"].success(t.$t("People.succeed"))}catch(e){g["a"].error(e.message)}k.value=!1};return Object(l["onMounted"])((()=>{f(),y()})),{handleInputSearch:D,searchValue:w,commodityId:j,ComfirmBuyGoods:_,buyGoodRules:S,AllOrgData:h,buyGoodMessage:O,buyGoodDialog:k,currentUser:c,handleBuyGood:P,allTabelDate:o,TabelDate:r,loading:a,getStatus:m,formatterTime:$,forateTime:v}},methods:{handleSizeChange(e){this.pageSize=e},handleCurrentChange(e){this.currentPage=e}}}),p=b,m=a("2877"),f=Object(m["a"])(p,r,o,!1,null,null,null);t["default"]=f.exports}}]);