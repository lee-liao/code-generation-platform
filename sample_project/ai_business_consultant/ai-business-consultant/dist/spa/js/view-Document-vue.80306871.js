(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[17],{"5c0f":function(e,t,a){},"97cb":function(e,t,a){"use strict";a("5c0f")},cabd:function(e,t,a){"use strict";a.r(t);var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"px-10 py-5"},[a("el-tabs",{staticClass:"mx-5 my-2",model:{value:e.activeName,callback:function(t){e.activeName=t},expression:"activeName"}},[a("el-tab-pane",{attrs:{label:e.$t("document.todo"),name:"1"}},[a("div",{staticStyle:{width:"100%",margin:"30px 0",display:"flex","justify-content":"space-between"}},[a("el-input",{staticStyle:{width:"200px"},attrs:{clearable:"",placeholder:e.$t("document.orderSearch")},on:{input:e.handleInputSearch},model:{value:e.searchUnapprove,callback:function(t){e.searchUnapprove=t},expression:"searchUnapprove"}},[a("i",{staticClass:"el-input__icon el-icon-search",attrs:{slot:"prefix"},slot:"prefix"})])],1),a("el-table",{staticClass:"mb-5",staticStyle:{width:"100%"},attrs:{data:e.unApproveData,border:"","empty-text":e.$t("People.noData")}},[a("el-table-column",{attrs:{prop:"id",label:e.$t("document.user"),align:"center","min-width":"100%"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("div",{staticStyle:{width:"100%",display:"flex","align-items":"center","justify-content":"left","margin-left":"10px"}},[a("j-avatar",{staticClass:"shadow-outline-white -ml-1",attrs:{size:28,avatarUrl:t.row.wxUser.avatarUrl,name:"xxxxx"}}),a("span",{staticStyle:{"margin-left":"10px"}},[e._v(e._s(t.row.wxUser.name))])],1)]}}])}),a("el-table-column",{attrs:{prop:"name",label:e.$t("document.type"),align:"center","min-width":"100%"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n            "+e._s(t.row.legalDocumentProject.name)+"\n          ")]}}])}),a("el-table-column",{attrs:{prop:"out_trade_no",label:e.$t("document.orderNo"),align:"center","min-width":"100%"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n            "+e._s(t.row.wxPaidOrders.out_trade_no)+"\n          ")]}}])}),a("el-table-column",{attrs:{prop:"commodity",label:e.$t("document.goodsName"),align:"center","min-width":"100%"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n            "+e._s(t.row.wxPaidOrders.commodity?t.row.wxPaidOrders.commodity.name:"")+"\n          ")]}}])}),a("el-table-column",{attrs:{prop:"confirmedAt",label:e.$t("document.confirmDate"),align:"center","min-width":"100%"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n            "+e._s(e.forateTime(t.row.confirmedAt))+"\n          ")]}}])}),a("el-table-column",{attrs:{label:e.$t("People.action"),align:"center","min-width":"180%"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{type:"text"},on:{click:function(a){return e.handleApproval(t.row)}}},[e._v("\n              "+e._s(e.$t("document.Approval"))+"\n            ")])]}}])})],1),a("el-pagination",{attrs:{"current-page":e.currentPage,"page-sizes":[5,10,20,50],"page-size":e.pageSize,total:e.totalunApprove,layout:"total, sizes, prev, pager, next, jumper"},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}})],1),a("el-tab-pane",{attrs:{label:e.$t("document.Completed"),name:"2"}},[a("div",{staticStyle:{width:"100%",margin:"30px 0",display:"flex","justify-content":"space-between"}},[a("el-input",{staticStyle:{width:"200px"},attrs:{clearable:"",placeholder:e.$t("document.orderSearch")},on:{input:e.handleInputSearch1},model:{value:e.searchApprove,callback:function(t){e.searchApprove=t},expression:"searchApprove"}},[a("i",{staticClass:"el-input__icon el-icon-search",attrs:{slot:"prefix"},slot:"prefix"})])],1),a("el-table",{staticClass:"mb-5",staticStyle:{width:"100%"},attrs:{data:e.approveData,border:"","empty-text":e.$t("People.noData")}},[a("el-table-column",{attrs:{prop:"id",label:e.$t("document.user"),align:"center","min-width":"100%"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("div",{staticStyle:{width:"100%",display:"flex","align-items":"center","justify-content":"left","margin-left":"10px"}},[a("j-avatar",{staticClass:"shadow-outline-white -ml-1",attrs:{size:28,avatarUrl:t.row.wxUser.avatarUrl,name:"xxxxx"}}),a("span",{staticStyle:{"margin-left":"10px"}},[e._v(e._s(t.row.wxUser.name))])],1)]}}])}),a("el-table-column",{attrs:{prop:"name",label:e.$t("document.type"),align:"center","min-width":"100%"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n            "+e._s(t.row.legalDocumentProject.name)+"\n          ")]}}])}),a("el-table-column",{attrs:{prop:"out_trade_no",label:e.$t("document.orderNo"),align:"center","min-width":"100%"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n            "+e._s(t.row.wxPaidOrders.out_trade_no)+"\n          ")]}}])}),a("el-table-column",{attrs:{prop:"commodity",label:e.$t("document.goodsName"),align:"center","min-width":"100%"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n            "+e._s(t.row.wxPaidOrders.commodity?t.row.wxPaidOrders.commodity.name:"")+"\n          ")]}}])}),a("el-table-column",{attrs:{prop:"confirmedAt",label:e.$t("document.confirmDate"),align:"center","min-width":"100%"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n            "+e._s(e.forateTime(t.row.confirmedAt))+"\n          ")]}}])}),a("el-table-column",{attrs:{label:"AI版本",align:"center","min-width":"50%"},scopedSlots:e._u([{key:"default",fn:function(t){return[null!==t.row.aiFileUrl?a("el-button",{attrs:{type:"text"},on:{click:function(a){return e.handleDownLoadAIUrl(t.row)}}},[e._v("\n              "+e._s(e.$t("document.Download"))+"\n            ")]):e._e()]}}])}),a("el-table-column",{attrs:{label:e.$t("People.action"),align:"center","min-width":"180%"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{type:"text"},on:{click:function(a){return e.handleApproval(t.row)}}},[e._v("\n              "+e._s(e.$t("document.Approval"))+"\n            ")]),a("el-button",{attrs:{type:"text"},on:{click:function(a){return e.handleApprovedPreview(t.row)}}},[e._v("\n              "+e._s(e.$t("document.Preview"))+"\n            ")]),a("el-button",{attrs:{type:"text"},on:{click:function(a){return e.handleDownLoad(t.row)}}},[e._v("\n              "+e._s(e.$t("document.Download"))+"\n            ")]),a("el-button",{attrs:{type:"text"},on:{click:function(a){return e.handleReleaseDoucment(t.row)}}},[e._v(e._s(e.$t("document.Release")))])]}}])})],1),a("el-pagination",{attrs:{"current-page":e.currentPage1,"page-sizes":[5,10,20,50],"page-size":e.pageSize1,total:e.totalApprove,layout:"total, sizes, prev, pager, next, jumper"},on:{"size-change":e.handleSizeChange1,"current-change":e.handleCurrentChange1}})],1),a("el-tab-pane",{attrs:{label:e.$t("document.fail"),name:"3"}},[a("div",{staticStyle:{width:"100%",margin:"30px 0",display:"flex","justify-content":"space-between"}},[a("el-input",{staticStyle:{width:"200px"},attrs:{clearable:"",placeholder:e.$t("document.orderSearch")},on:{input:e.handleInputSearch2},model:{value:e.searchFail,callback:function(t){e.searchFail=t},expression:"searchFail"}},[a("i",{staticClass:"el-input__icon el-icon-search",attrs:{slot:"prefix"},slot:"prefix"})])],1),a("el-table",{staticClass:"mb-5",staticStyle:{width:"100%"},attrs:{data:e.failData,border:"","empty-text":e.$t("People.noData")}},[a("el-table-column",{attrs:{prop:"id",label:e.$t("document.user"),align:"center","min-width":"100%"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("div",{staticStyle:{width:"100%",display:"flex","align-items":"center","justify-content":"left","margin-left":"10px"}},[a("j-avatar",{staticClass:"shadow-outline-white -ml-1",attrs:{size:28,avatarUrl:t.row.wxUser.avatarUrl,name:"xxxxx"}}),a("span",{staticStyle:{"margin-left":"10px"}},[e._v(e._s(t.row.wxUser.name))])],1)]}}])}),a("el-table-column",{attrs:{prop:"name",label:e.$t("document.type"),align:"center","min-width":"100%"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n            "+e._s(t.row.legalDocumentProject.name)+"\n          ")]}}])}),a("el-table-column",{attrs:{prop:"out_trade_no",label:e.$t("document.orderNo"),align:"center","min-width":"100%"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n            "+e._s(t.row.wxPaidOrders.out_trade_no)+"\n          ")]}}])}),a("el-table-column",{attrs:{prop:"commodity",label:e.$t("document.goodsName"),align:"center","min-width":"100%"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n            "+e._s(t.row.wxPaidOrders.commodity?t.row.wxPaidOrders.commodity.name:"")+"\n          ")]}}])}),a("el-table-column",{attrs:{prop:"errorInfo",label:e.$t("document.errorInfo"),align:"center","min-width":"100%"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:t.row.errorInfo,placement:"top"}},[a("div",{staticStyle:{overflow:"hidden","text-overflow":"ellipsis",display:"-webkit-box","-webkit-line-clamp":"3","-webkit-box-orient":"vertical"}},[e._v("\n                "+e._s(t.row.errorInfo)+"\n              ")])])]}}])}),a("el-table-column",{attrs:{prop:"confirmedAt",label:e.$t("document.confirmDate"),align:"center","min-width":"100%"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n            "+e._s(e.forateTime(t.row.confirmedAt))+"\n          ")]}}])}),a("el-table-column",{attrs:{label:e.$t("People.action"),align:"center","min-width":"50%"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{type:"text"},on:{click:function(a){return e.handleApproval(t.row)}}},[e._v("\n              "+e._s(e.$t("document.Approval"))+"\n            ")])]}}])})],1),a("el-pagination",{attrs:{"current-page":e.currentPage2,"page-sizes":[5,10,20,50],"page-size":e.pageSize2,total:e.totalError,layout:"total, sizes, prev, pager, next, jumper"},on:{"size-change":e.handleSizeChange2,"current-change":e.handleCurrentChange2}})],1)],1),a("el-dialog",{attrs:{visible:e.chatHistoryDialogVisible,"close-on-click-modal":!1,width:"60%",center:""},on:{"update:visible":function(t){e.chatHistoryDialogVisible=t}}},e._l(e.chatHistory,(function(t){return a("div",{key:t.created,staticClass:"mt-3",staticStyle:{display:"flex"}},[a("div",{staticClass:"column"},[a("span",{staticClass:"mr-3",style:{whiteSpace:"nowrap",width:"250px",color:"#0747A6"}},[e._v(e._s("user"==t.role?e.$t("document.user"):"system"==t.role?e.$t("document.system"):e.$t("document.assistant"))+"\n          "+e._s(e._f("formatDateTime")(t.created))+" :")]),a("span",[e._v(" "+e._s(t.content))])])])})),0),a("el-dialog",{attrs:{visible:e.preivewDialogVisible,"close-on-click-modal":!1,width:"60%",center:""},on:{"update:visible":function(t){e.preivewDialogVisible=t}}},[a("div",{domProps:{innerHTML:e._s(e.convertedContent)}})]),a("el-dialog",{staticClass:"custom-dialog",staticStyle:{"z-index":"99999"},attrs:{visible:e.centerDialogVisible,"close-on-click-modal":!1,fullscreen:"","show-close":!1,width:"30%",center:""},on:{"update:visible":function(t){e.centerDialogVisible=t}}},[a("div",{staticClass:"row"},[a("div",{staticClass:"column",staticStyle:{width:"30%"}},[a("span",[e._v(e._s(e.$t("document.Element")))]),a("json-viewer",{staticClass:"w-100% mt-1 ml-3",staticStyle:{"box-shadow":"0 0 8px rgba(0, 0, 0, 0.1)",height:"600px","overflow-y":"auto"},attrs:{value:e.itemData.dataJson,"expand-depth":5,boxed:"",expanded:""}})],1),a("div",{staticClass:"column ml-3",staticStyle:{width:"30%"}},[a("span",[e._v(e._s(e.$t("Wxuser.chatHistory")))]),a("div",{staticClass:"border-box mt-1 px-3 py-3",staticStyle:{height:"600px","overflow-y":"auto"}},e._l(e.chatHistory,(function(t){return a("div",{key:t.created,staticClass:"mt-3",staticStyle:{display:"flex"}},[a("div",{staticClass:"column"},[a("span",{staticClass:"mr-3",style:{whiteSpace:"nowrap",width:"250px",color:"#0747A6"}},[e._v(e._s("user"==t.role?e.$t("document.user"):"system"==t.role?e.$t("document.system"):e.$t("document.assistant"))+"\n                "+e._s(e._f("formatDateTime")(t.created))+" :")]),a("span",[e._v(" "+e._s(t.content))])])])})),0)]),a("div",{staticClass:"column ml-5",staticStyle:{width:"37%"}},[a("span",[e._v(e._s(e.$t("document.Document")))]),a("div",{staticClass:"border-box mt-1 px-3 py-3",staticStyle:{height:"600px","overflow-y":"auto"}},[a("div",{staticStyle:{height:"600px","overflow-y":"auto",width:"37%"},attrs:{id:"container"}})])])]),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{type:"primary"},on:{click:function(t){e.centerDialogVisible=!1}}},[e._v(e._s(e.$t("document.Back")))]),a("el-button",{on:{click:e.handleSave}},[e._v(e._s(e.$t("document.Save")))]),a("el-button",{on:{click:e.exportWord}},[e._v("\n        "+e._s(e.$t("document.Download"))+"\n      ")]),a("el-button",{on:{click:e.handlePreview}},[e._v("\n        "+e._s(e.$t("document.Preview"))+"\n      ")]),a("el-button",{attrs:{type:"primary"},on:{click:e.handleRelease}},[e._v(e._s(e.$t("document.Release")))])],1)]),a("el-dialog",{attrs:{width:"70%","close-on-click-modal":!1,visible:e.previewDialog,"modal-append-to-body":!1,"destroy-on-close":!0},on:{"update:visible":function(t){e.previewDialog=t}}},[a("div",{staticClass:"column items-center"},[a("iframe",{attrs:{src:"https://view.officeapps.live.com/op/view.aspx?src="+e.itemData.fileUrl,width:"100%",height:"700px"}})])])],1)},o=[],l=(a("ddb0"),a("2b3d"),a("9861"),a("5319"),a("caad"),a("5b81"),a("750b")),r=(a("ac79"),a("1840")),s=a("6560"),i=(a("db56"),a("6eb7")),c=a("b850"),u=(a("fbf9"),a("c4e3"),a("0083"),a("5a0c")),d=a.n(u),p=(a("8ee3"),a("c343")),m=a.n(p),v=(a("21a6"),a("281c"),a("f526")),f=a("fadb"),w=Object(l["defineComponent"])({name:"Login",components:{},data(){return{}},mounted(){Object(f["b"])(this,"isMobile")},setup(e,{root:t}){const a=Object(l["ref"])([]),{mutate:n}=Object(r["useMutation"])(s["c"]),{mutate:o}=Object(r["useMutation"])(s["h"]),{mutate:u}=Object(r["useMutation"])(s["b"]),{mutate:p}=Object(r["useMutation"])(s["f"]),{mutate:f}=Object(r["useMutation"])(s["e"]),{mutate:w}=Object(r["useMutation"])(s["d"]),h=(e,t="YYYY/MM/DD  HH:mm:ss")=>e?d()(e).format(t):e,b=Object(l["ref"])(""),_=Object(l["ref"])(""),g=Object(l["ref"])(""),y=async e=>{console.log("sssssss",e),fetch(e.fileUrl).then((t=>{t.blob().then((t=>{const a=window.URL.createObjectURL(t),n=document.createElement("a");n.href=a,n.download=e.legalDocumentProject.name+"_"+e.wxPaidOrders.out_trade_no+".docx",n.click(),window.URL.revokeObjectURL(a)}))}))},x=Object(l["ref"])(!1),k=Object(l["ref"])(!1),S=Object(l["ref"])(!1),C=Object(l["ref"])(""),O={id:0,docJson:"",chatJson:"",dataJson:"",reviewDocJson:"",openid:"",fileUrl:"",projectName:"",out_trade_no:""},j=()=>{Object(v["a"])(O.fileUrl,""==O.reviewDocJson?JSON.parse(O.docJson.replace(/\\n/g,"<w:br />")):JSON.parse(O.reviewDocJson.replace(/\\n/g,"<w:br />")),O.projectName+"_"+O.out_trade_no+".docx"),console.log("66666666",JSON.parse(O.docJson.replace(/\n/g,"<w:br />")))},$=Object(l["ref"])(!1),D=async()=>{const e={};pe.value.forEach(((t,a)=>{e[`${t.label}`]=t.value}));const a={reviewDocJson:JSON.stringify(e)},n=await o({paperwork:a,id:O.id});n&&i["a"].success(t.$t("notify.Done"))},P=Object(l["ref"])([]),A=async()=>{const e={};pe.value.forEach(((t,a)=>{e[`${t.label}`]=t.value}));const a={reviewDocJson:JSON.stringify(e)},n=await o({paperwork:a,id:O.id});if(n){const e=await f({id:O.id});e&&(i["a"].success(t.$t("document.ReleaseSuccess")),ee(),x.value=!1)}},U=async()=>{if(""===b.value)Y();else{H.value=1;const e=await w({take:M.value,skip:(H.value-1)*M.value,state:"unapproved",out_trade_no:b.value});e&&(oe.value=e.data.getPaperworksAndCount.data,L.value=e.data.getPaperworksAndCount.totalCount)}},z=async()=>{if(""===g.value)B();else{V.value=1;const e=await w({take:E.value,skip:(V.value-1)*E.value,state:"approved",out_trade_no:g.value});e&&(ne.value=e.data.getPaperworksAndCount.data,R.value=e.data.getPaperworksAndCount.totalCount)}},J=async()=>{if(""===_.value)W();else{T.value=1;const e=await w({take:F.value,skip:(T.value-1)*F.value,state:"error",out_trade_no:_.value});e&&(le.value=e.data.getPaperworksAndCount.data,I.value=e.data.getPaperworksAndCount.totalCount)}},N=async e=>{const a=await f({id:e.id});a&&(i["a"].success(t.$t("document.ReleaseSuccess")),ee(),x.value=!1)},R=Object(l["ref"])(0),L=Object(l["ref"])(0),I=Object(l["ref"])(0),H=Object(l["ref"])(1),M=Object(l["ref"])(5),V=Object(l["ref"])(1),E=Object(l["ref"])(5),T=Object(l["ref"])(1),F=Object(l["ref"])(5),Y=async()=>{const e=await w({take:M.value,skip:(H.value-1)*M.value,state:"unapproved"});e&&(oe.value=e.data.getPaperworksAndCount.data,L.value=e.data.getPaperworksAndCount.totalCount)},B=async()=>{const e=await w({take:E.value,skip:(V.value-1)*E.value,state:"approved"});e&&(ne.value=e.data.getPaperworksAndCount.data,R.value=e.data.getPaperworksAndCount.totalCount)},W=async()=>{const e=await w({take:F.value,skip:(T.value-1)*F.value,state:"error"});e&&(le.value=e.data.getPaperworksAndCount.data,I.value=e.data.getPaperworksAndCount.totalCount)},q=e=>{M.value=e,Y()},G=e=>{E.value=e,B()},K=e=>{F.value=e,W()},Q=e=>{H.value=e,Y()},X=e=>{V.value=e,B()},Z=e=>{T.value=e,W()},ee=async()=>{console.log("getAllPaper"),B(),Y(),W()},te=async()=>{pe.value.forEach((e=>{C.value=C.value.replace("{"+e.label+"}",e.value)})),k.value=!0},ae=e=>{O.fileUrl=e.fileUrl,S.value=!0},ne=Object(l["ref"])([]),oe=Object(l["ref"])([]),le=Object(l["ref"])([]),re=()=>{oe.value=oe.value.filter((e=>e.wxPaidOrders.out_trade_no.includes(b.value)))},se=()=>{le.value=le.value.filter((e=>e.wxPaidOrders.out_trade_no.includes(_.value)))},ie=()=>{ne.value=ne.value.filter((e=>e.wxPaidOrders.out_trade_no.includes(g.value)))},ce=e=>{t.$router.push("/document/"+e.id)},ue=Object(l["ref"])([]),de=e=>{ue.value=[],O.chatJson=e.chatJson,null!=O.chatJson&&(ue.value=JSON.parse(O.chatJson.replaceAll(/\n/g,"\\n").replaceAll(/\r/g,"\\r"))),$.value=!0},pe=Object(l["ref"])([]),me=e=>{fetch(e).then((e=>e.arrayBuffer())).then((e=>m.a.convertToHtml({arrayBuffer:e}))).then((e=>{C.value=e.value})).catch((e=>{console.error(e)}))},ve=e=>{console.log("dddd",e),fetch(e.aiFileUrl).then((t=>{t.blob().then((t=>{const a=window.URL.createObjectURL(t),n=document.createElement("a");n.href=a,n.download=e.legalDocumentProject.name+"_"+e.wxPaidOrders.out_trade_no+".docx",n.click(),window.URL.revokeObjectURL(a)}))}))};return Object(l["onMounted"])((()=>{const e=Object(l["computed"])(c["b"].currentUser);1!=e.value.role&&2!=e.value.role?5==e.value.role?t.$router.push("/user"):6==e.value.role?t.$router.push("/DistributorOrg"):t.$router.push("/workflow"):ee()})),{activeName:"1",handleApproval:ce,approveData:ne,searchUnapprove:b,searchFail:_,failData:le,handleFail:se,searchApprove:g,unApproveData:oe,handleUnapprove:re,handleApprove:ie,unApprovetableData:P,chatHistoryDialogVisible:$,handleChatHistory:de,handleApprovedPreview:ae,previewDialog:S,chatHistory:ue,elements:pe,handleSave:D,handlePreview:te,handleInputSearch:U,handleInputSearch1:z,handleInputSearch2:J,tableData:a,exportWord:j,handleDownLoad:y,handleRelease:A,handleReleaseDoucment:N,preivewDialogVisible:k,loadAndConvertDocument:me,convertedContent:C,centerDialogVisible:x,itemData:O,forateTime:h,totalApprove:R,totalunApprove:L,totalError:I,pageSize:M,pageSize1:E,pageSize2:F,currentPage:H,currentPage1:V,currentPage2:T,handleSizeChange:q,handleCurrentChange:Q,handleSizeChange1:G,handleCurrentChange1:X,handleSizeChange2:K,handleCurrentChange2:Z,handleDownLoadAIUrl:ve}},methods:{}}),h=w,b=(a("97cb"),a("2877")),_=Object(b["a"])(h,n,o,!1,null,"1f77b8a8",null);t["default"]=_.exports}}]);