(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[13],{"5e7d":function(e,t,a){},"60f0":function(e,t,a){"use strict";a.r(t);var r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"w-full h-full px-12"},[a("div",{staticStyle:{width:"100%",margin:"20px 0",display:"flex","justify-content":"space-between"}},[a("el-input",{staticStyle:{width:"200px"},attrs:{placeholder:e.$t("People.searchForName")},on:{input:e.handleInputSearch},model:{value:e.searchValue,callback:function(t){e.searchValue=t},expression:"searchValue"}},[a("i",{staticClass:"el-input__icon el-icon-search",attrs:{slot:"prefix"},slot:"prefix"})]),a("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.openCreateOrgDialog()}}},[e._v("\n      "+e._s(e.$t("Distributor.Addorganization"))+"\n    ")])],1),a("div",[a("el-table",{staticClass:"mb-5",staticStyle:{width:"100%"},attrs:{data:e.AllOrgData.slice((e.currentPage-1)*e.pageSize,e.currentPage*e.pageSize),border:"","empty-text":e.$t("People.noData")}},[a("el-table-column",{attrs:{prop:"name",label:e.$t("Distributor.OrganizationName"),align:"center","min-width":"100%"}}),a("el-table-column",{attrs:{prop:"createdAt",label:e.$t("goods.createdAt"),align:"center",formatter:e.formatterTime}}),a("el-table-column",{attrs:{label:e.$t("People.action"),align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{type:"text"},on:{click:function(a){return e.updateOrgInfo(t.row)}}},[e._v(e._s(e.$t("People.edit")))]),a("el-button",{attrs:{type:"text"},on:{click:function(a){return e.createMenu(t.row)}}},[e._v(e._s(e.$t("Distributor.Createofficialaccountmenu")))])]}}])})],1),a("el-pagination",{attrs:{"current-page":e.currentPage,"page-sizes":[5,10,20,50],"page-size":e.pageSize,total:e.AllOrgData.length,layout:"total, sizes, prev, pager, next, jumper"},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}})],1),a("el-dialog",{attrs:{title:e.createOrEditTitle+" "+e.$t("Distributor.organization"),visible:e.OrgDialogVisible,center:"",width:"60%"},on:{"update:visible":function(t){e.OrgDialogVisible=t},close:e.handleClose}},[e.isUploadFile?e._e():a("div",{staticClass:"dialog-container"},[a("div",{staticClass:"left-form"},[a("span",{staticStyle:{display:"flex","justify-content":"center","font-size":"16px","margin-bottom":"30px"}},[e._v(e._s(e.$t("Distributor.OrganizationalInformation")))]),a("el-form",{attrs:{model:e.OrgInfo,rules:e.OrgInfoRules,"label-width":"250px"}},[a("el-form-item",{attrs:{label:e.$t("Distributor.PublicName"),prop:"name"}},[a("el-input",{model:{value:e.OrgInfo.name,callback:function(t){e.$set(e.OrgInfo,"name",t)},expression:"OrgInfo.name"}})],1),a("el-form-item",{attrs:{label:e.$t("Distributor.DeveloperID"),prop:"wxAppId"}},[a("el-input",{model:{value:e.OrgInfo.wxAppId,callback:function(t){e.$set(e.OrgInfo,"wxAppId",t)},expression:"OrgInfo.wxAppId"}})],1),a("el-form-item",{attrs:{label:e.$t("Distributor.DeveloperPassword"),prop:"wxAppSecret"}},[a("el-input",{model:{value:e.OrgInfo.wxAppSecret,callback:function(t){e.$set(e.OrgInfo,"wxAppSecret",t)},expression:"OrgInfo.wxAppSecret"}})],1),a("el-form-item",{attrs:{label:e.$t("Distributor.WeChatPayMerchantAccount"),prop:"wxMchId"}},[a("el-input",{model:{value:e.OrgInfo.wxMchId,callback:function(t){e.$set(e.OrgInfo,"wxMchId",t)},expression:"OrgInfo.wxMchId"}})],1),a("el-form-item",{attrs:{label:e.$t("Distributor.APICertificateSerialNumber"),prop:"wxSerialNo"}},[a("el-input",{model:{value:e.OrgInfo.wxSerialNo,callback:function(t){e.$set(e.OrgInfo,"wxSerialNo",t)},expression:"OrgInfo.wxSerialNo"}})],1),a("el-form-item",{attrs:{label:e.$t("Distributor.InternationalRSACertificateSerialNumber"),prop:"wxPublicKey"}},[a("el-input",{model:{value:e.OrgInfo.wxPublicKey,callback:function(t){e.$set(e.OrgInfo,"wxPublicKey",t)},expression:"OrgInfo.wxPublicKey"}})],1),a("el-form-item",{attrs:{label:e.$t("Distributor.ReminderTemplateID"),prop:"reminderWxTemplateId2"}},[a("el-input",{model:{value:e.OrgInfo.reminderWxTemplateId2,callback:function(t){e.$set(e.OrgInfo,"reminderWxTemplateId2",t)},expression:"OrgInfo.reminderWxTemplateId2"}})],1),a("el-form-item",{attrs:{label:e.$t("Distributor.CompleteTemplateID"),prop:"completeWxTemplateId8"}},[a("el-input",{model:{value:e.OrgInfo.completeWxTemplateId8,callback:function(t){e.$set(e.OrgInfo,"completeWxTemplateId8",t)},expression:"OrgInfo.completeWxTemplateId8"}})],1)],1)],1),e.createOrEditTitle==e.$t("People.add")?a("div",{staticClass:"right-form"},[a("span",{staticStyle:{display:"flex","justify-content":"center","font-size":"16px","margin-bottom":"30px"}},[e._v(e._s(e.$t("Distributor.AdministratorInformation")))]),a("el-form",{ref:"adminFormRef",attrs:{model:e.adminInfo,rules:e.adminInfoRules,"label-width":"150px"}},[a("el-form-item",{attrs:{label:e.$t("People.userName"),prop:"name"}},[a("el-input",{model:{value:e.adminInfo.name,callback:function(t){e.$set(e.adminInfo,"name",t)},expression:"adminInfo.name"}})],1),a("el-form-item",{attrs:{label:e.$t("People.email"),prop:"email"}},[a("el-input",{model:{value:e.adminInfo.email,callback:function(t){e.$set(e.adminInfo,"email",t)},expression:"adminInfo.email"}})],1),a("el-form-item",{attrs:{label:e.$t("People.InitialPassword"),prop:"password"}},[a("el-input",{model:{value:e.adminInfo.password,callback:function(t){e.$set(e.adminInfo,"password",t)},expression:"adminInfo.password"}})],1),a("el-form-item",{attrs:{label:e.$t("People.Phone"),prop:"phone"}},[a("el-input",{model:{value:e.adminInfo.phone,callback:function(t){e.$set(e.adminInfo,"phone",t)},expression:"adminInfo.phone"}})],1),a("el-form-item",{attrs:{label:e.$t("register.des"),prop:"desc"}},[a("el-input",{model:{value:e.adminInfo.desc,callback:function(t){e.$set(e.adminInfo,"desc",t)},expression:"adminInfo.desc"}})],1)],1)],1):e._e()]),e.isUploadFile?a("div",[a("span",{staticStyle:{display:"flex","justify-content":"center","font-size":"16px","margin-bottom":"30px"}},[e._v(e._s(e.$t("Distributor.OrganizationalInformation")))]),a("el-form",{ref:"orgFormRef",attrs:{model:e.OrgInfo,rules:e.OrgInfoRules,"label-width":"155px"}},[a("el-form-item",{attrs:{label:e.$t("Distributor.certificatep12"),prop:"apiClientCertP12"}},[a("div",{staticStyle:{display:"flex","align-items":"center"}},[a("el-input",{staticStyle:{width:"85%"},model:{value:e.OrgInfo.apiClientCertP12,callback:function(t){e.$set(e.OrgInfo,"apiClientCertP12",t)},expression:"OrgInfo.apiClientCertP12"}}),a("el-upload",{staticClass:"upload-demo",attrs:{action:"","on-success":e.handleSuccessApiClientCertP12,"http-request":e.customRequest,"show-file-list":!1}},[a("el-button",{staticStyle:{"margin-left":"20px"},attrs:{size:"medium",type:"primary"}},[e._v(e._s(e.$t("upload.browse")))])],1)],1)]),a("el-form-item",{attrs:{label:e.$t("Distributor.certificatepem"),prop:"apiClientCertPem"}},[a("div",{staticStyle:{display:"flex","align-items":"center"}},[a("el-input",{staticStyle:{width:"85%"},model:{value:e.OrgInfo.apiClientCertPem,callback:function(t){e.$set(e.OrgInfo,"apiClientCertPem",t)},expression:"OrgInfo.apiClientCertPem"}}),a("el-upload",{staticClass:"upload-demo",attrs:{action:"","http-request":e.customRequest,"on-success":e.handleSuccessApiClientCertPem,"show-file-list":!1,accept:".pem,application/x-x509-ca-cert"}},[a("el-button",{staticStyle:{"margin-left":"20px"},attrs:{size:"medium",type:"primary"}},[e._v(e._s(e.$t("upload.browse")))])],1)],1)]),a("el-form-item",{attrs:{label:e.$t("Distributor.Keypem"),prop:"apiClientKeyPem"}},[a("div",{staticStyle:{display:"flex","align-items":"center"}},[a("el-input",{staticStyle:{width:"85%"},model:{value:e.OrgInfo.apiClientKeyPem,callback:function(t){e.$set(e.OrgInfo,"apiClientKeyPem",t)},expression:"OrgInfo.apiClientKeyPem"}}),a("el-upload",{staticClass:"upload-demo",attrs:{action:"","http-request":e.customRequest,"on-success":e.handleSuccessApiClientKeyPem,"show-file-list":!1,accept:".pem,application/x-x509-ca-cert"}},[a("el-button",{staticStyle:{"margin-left":"20px"},attrs:{size:"medium",type:"primary"}},[e._v(e._s(e.$t("upload.browse")))])],1)],1)]),a("el-form-item",{attrs:{label:e.$t("Distributor.DomainNameOfOfficialAccount"),prop:"wxDomainPath"}},[a("div",{staticStyle:{display:"flex","align-items":"center"}},[a("el-input",{staticStyle:{width:"85%"},model:{value:e.OrgInfo.wxDomainPath,callback:function(t){e.$set(e.OrgInfo,"wxDomainPath",t)},expression:"OrgInfo.wxDomainPath"}}),a("el-upload",{staticClass:"upload-demo",attrs:{action:"","http-request":e.customRequestTestFile,"on-success":e.handleSuccessWxDomainPath,"show-file-list":!1}},[a("el-button",{staticStyle:{"margin-left":"20px"},attrs:{size:"medium",type:"primary"}},[e._v(e._s(e.$t("upload.browse")))])],1)],1)])],1)],1):e._e(),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[e.isUploadFile?e._e():a("el-button",{on:{click:function(t){return e.closeDialog()}}},[e._v(e._s(e.$t("People.cancel")))]),e.isUploadFile?a("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.previousStep()}}},[e._v(e._s(e.$t("Distributor.previousstep")))]):e._e(),e.isUploadFile?e._e():a("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.nextStep()}}},[e._v(e._s(e.$t("Distributor.nextstep")))]),e.isUploadFile?a("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.ComfirmCreateOrg()}}},[e._v(e._s(e.$t("People.confirm")))]):e._e()],1)])],1)},i=[],l=(a("caad"),a("750b")),n=(a("b850"),a("1840")),o=a("5a0c"),s=a.n(o),p=(a("ac79"),a("6eb7")),u=a("436b"),c=(a("cdde"),a("5184"));const m=c["a"]`
mutation createOrganization ($admin: AdminCreateInput!,$organization: OrganizationInput!)  {
    createOrganization(admin: $admin,organization: $organization) {
        id
        name
}
  }
`,d=c["a"]`
mutation updateOrganization ($organization: OrganizationUpdateInput!)  {
    updateOrganization(organization: $organization) {
        id
        name
}
  }
`,f=(c["a"]`
  mutation deleteOrganization($id: Float!) {
    deleteOrganization(id: $id)
  }
  `,c["a"]`
query getAllOrganizations {
    getAllOrganizations {
        id
        name
        createdAt
        updatedAt
        wxAppSecret
        wxMchId
        wxSerialNo
        wxPublicKey
        apiClientCertP12
        apiClientCertPem
        apiClientKeyPem
        publicKeyPem
        uuid
        deletedAt
        completeWxTemplateId8
        reminderWxTemplateId2
        wxAppId
        wxDomainPath
  }
}
`),g=(c["a"]`query getOrganizationByPathUrl($pathUrl: String!) {
  getOrganizationByPathUrl(pathUrl: $pathUrl) {
      id
      name
      adminId
      plan
      pathUrl
      payment
      creditCard
  }
}`,c["a"]`
query createWxOfficialAccountMenus($orgId: Int!) {
    createWxOfficialAccountMenus(orgId: $orgId)
}
`);c["a"]`
query getOrganization {
    getOrganization {
       id
       name
       createdAt
       updatedAt
       carouselImages
       mainImages
       modelText
       usageExamples
       lawyers
  }
}
`;var b=a("fadb"),x=a("bc3a"),h=a.n(x),I=Object(l["defineComponent"])({data(){return{isMobile:Object(b["a"])(),currentPage:1,pageSize:10}},mounted(){Object(b["b"])(this,"isMobile")},setup(e,{root:t}){const{mutate:a}=Object(n["useMutation"])(f),{mutate:r}=Object(n["useMutation"])(m),{mutate:i}=Object(n["useMutation"])(d),{mutate:o}=Object(n["useMutation"])(g),c=Object(l["ref"])(null),b=Object(l["ref"])(null),x=Object(l["ref"])([]),I=Object(l["ref"])([]),P=async()=>{try{const{data:{getAllOrganizations:e}}=await a();x.value=e,I.value=e,console.log("dddd",x.value)}catch(e){console.log("----------getOrg error")}},w=Object(l["ref"])({name:"",email:"",password:"",phone:"",avatarUrl:"https://file.sflow.pro/avatar_default.png",desc:""}),v=Object(l["ref"])({name:"",wxAppId:"",wxAppSecret:"",wxMchId:"",wxSerialNo:"",wxPublicKey:"",apiClientCertP12:"",apiClientCertPem:"",apiClientKeyPem:"",wxDomainPath:"",reminderWxTemplateId2:"",completeWxTemplateId8:""}),C={name:[{required:!0,message:t.$t("People.userNameMessage"),trigger:"blur"}],phone:[{required:!0,message:t.$t("People.userPhoneMessage"),trigger:"blur"}],email:[{required:!0,message:t.$t("People.userEmailMessage"),trigger:"blur"}],password:[{required:!0,message:t.$t("Distributor.Pleaseentertheinitialpassword"),trigger:"blur"}]},y={name:[{required:!0,message:t.$t("Distributor.Pleaseenterthepublicname"),trigger:"blur"}],wxAppId:[{required:!0,message:t.$t("Distributor.PleaseenterthedeveloperID"),trigger:"blur"}],wxAppSecret:[{required:!0,message:t.$t("Distributor.Pleaseenterthedeveloperpassword"),trigger:"blur"}],wxMchId:[{required:!0,message:t.$t("Distributor.PeaseenteryourWeChatPaymerchantaccount"),trigger:"blur"}],wxSerialNo:[{required:!0,message:t.$t("Distributor.PleaseentertheAPIcertificateserialnumber"),trigger:"blur"}],wxPublicKey:[{required:!0,message:t.$t("Distributor.Pleaseentertheinternational"),trigger:"blur"}],apiClientCertP12:[{required:!0,message:t.$t("Distributor.Pleaseuploadcertificatep12"),trigger:"blur"}],apiClientCertPem:[{required:!0,message:t.$t("Distributor.Pleaseuploadcertificatepem"),trigger:"blur"}],apiClientKeyPem:[{required:!0,message:t.$t("Distributor.Pleaseuploadthekeypem"),trigger:"blur"}],reminderWxTemplateId2:[{required:!0,message:t.$t("Distributor.PleaseentertheremindertemplateID"),trigger:"blur"}],completeWxTemplateId8:[{required:!0,message:t.$t("Distributor.PleaseenterthecompletedtemplateID"),trigger:"blur"}],wxDomainPath:[{required:!0,message:t.$t("Distributor.Pleaseuploadthedomain"),trigger:"blur"}]},O=(e,t="YYYY/MM/DD  HH:mm:ss")=>e?s()(e).format(t):e,$=e=>{let t=O(e.createdAt);return t},D=Object(l["ref"])(""),S=Object(l["ref"])(!1),A=()=>{D.value=t.$t("People.add"),S.value=!0,w.value={...w.value,name:"",email:"",password:"",phone:"",avatarUrl:"https://file.sflow.pro/avatar_default.png",desc:""},v.value={...v.value,name:"",wxAppId:"",wxAppSecret:"",wxMchId:"",wxSerialNo:"",wxPublicKey:"",apiClientCertP12:"",apiClientCertPem:"",apiClientKeyPem:"",reminderWxTemplateId2:"",completeWxTemplateId8:"",wxDomainPath:""}},z=Object(l["ref"])(0),_=e=>{D.value=t.$t("People.edit"),z.value=e.id,v.value={name:e.name,wxAppId:e.wxAppId,wxAppSecret:e.wxAppSecret,wxMchId:e.wxMchId,wxSerialNo:e.wxSerialNo,wxPublicKey:e.wxPublicKey,apiClientCertP12:e.apiClientCertP12,apiClientCertPem:e.apiClientCertPem,apiClientKeyPem:e.apiClientKeyPem,reminderWxTemplateId2:e.reminderWxTemplateId2,completeWxTemplateId8:e.completeWxTemplateId8,wxDomainPath:e.wxDomainPath},S.value=!0},T=Object(l["ref"])(!1),k=()=>{T.value=!0},q=()=>{T.value=!1},M=async({file:e,onSuccess:t,onError:a})=>{const r=localStorage.getItem("authToken");try{const a=new FormData;a.append("file",e);const i=await h.a.post("https://ort.saasflow.cn/upload/3",a,{headers:{Authorization:`Bearer ${r}`,"Content-Type":"multipart/form-data"}});t(i.data)}catch(i){a(i)}},W=async({file:e,onSuccess:t,onError:a})=>{const r=localStorage.getItem("authToken");try{const a=new FormData;a.append("file",e);const i=await h.a.post("https://ort.saasflow.cn/upload/1",a,{headers:{Authorization:`Bearer ${r}`,"Content-Type":"multipart/form-data"}});t(i.data)}catch(i){a(i)}},j=(e,t)=>{v.value.apiClientCertP12=t.name},K=(e,t)=>{v.value.apiClientCertPem=t.name},N=(e,t)=>{v.value.apiClientKeyPem=t.name},F=(e,t)=>{v.value.wxDomainPath=t.name},R=()=>{S.value=!1,T.value=!1},U=()=>{S.value=!1,T.value=!1},E=async()=>{if(D.value==t.$t("People.add")){if(""==w.value.name)return p["a"].error(t.$t("Distributor.Pleaseentertheinitialpassword"));if(""==w.value.email)return p["a"].error(t.$t("People.userEmailMessage"));if(""==w.value.password)return p["a"].error(t.$t("People.userNameMessage"));if(""==w.value.phone)return p["a"].error(t.$t("People.userPhoneMessage"));try{await b.value.validate()}catch(e){return p["a"].error(t.$t("Distributor.Pleasefillintheorganization"))}await r({admin:w.value,organization:v.value});P(),p["a"].success(t.$t("People.succeed")),S.value=!1,T.value=!1}else{try{await b.value.validate()}catch(e){return p["a"].error(t.$t("Distributor.Pleasefillintheorganization"))}await i({organization:v.value});P(),p["a"].success(t.$t("People.succeed")),S.value=!1,T.value=!1}},V=async e=>{u["a"].create({title:t.$t("People.confirm"),message:t.$t("Distributor.Confirmtocreatetheofficialaccountmenu"),ok:{label:t.$t("People.confirm"),noCaps:!0},cancel:{label:t.$t("People.cancel"),noCaps:!0,flat:!0},style:{zIndex:10002}}).onOk((async()=>{const a=await o({orgId:Number(e.id)});a&&p["a"].success(t.$t("notify.Done"))}))},B=Object(l["ref"])(""),Y=()=>{x.value=I.value.filter((e=>e.name.includes(B.value))),console.log(B.value,x.value)};return Object(l["onMounted"])((()=>{P()})),{filterAllOrgData:I,handleInputSearch:Y,searchValue:B,createMenu:V,handleClose:U,customRequestTestFile:W,orgFormRef:b,adminFormRef:c,orgId:z,customRequest:M,closeDialog:R,ComfirmCreateOrg:E,handleSuccessWxDomainPath:F,handleSuccessApiClientKeyPem:N,handleSuccessApiClientCertPem:K,handleSuccessApiClientCertP12:j,previousStep:q,nextStep:k,isUploadFile:T,updateOrgInfo:_,createOrEditTitle:D,formatterTime:$,adminInfoRules:C,OrgInfoRules:y,OrgInfo:v,adminInfo:w,OrgDialogVisible:S,openCreateOrgDialog:A,AllOrgData:x}},methods:{handleSizeChange(e){this.pageSize=e},handleCurrentChange(e){this.currentPage=e}}}),P=I,w=(a("c472"),a("2877")),v=Object(w["a"])(P,r,i,!1,null,"ae3f49a4",null);t["default"]=v.exports},c472:function(e,t,a){"use strict";a("5e7d")}}]);